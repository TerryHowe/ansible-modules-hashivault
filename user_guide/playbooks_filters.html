

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Filters &mdash; Ansible Documentation</title>
  

  
  
  
  
    <link rel="canonical" href="https://docs.ansible.com/ansible/latest/user_guide/playbooks_filters.html"/>
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>
  <link href='https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.0.3/css/font-awesome.min.css' rel='stylesheet' type='text/css'>

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/ansible.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/ansible.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Tests" href="playbooks_tests.html" />
    <link rel="prev" title="Templating (Jinja2)" href="playbooks_templating.html" /> <!---- extra head elements for Ansible beyond RTD Sphinx Theme --->
<script type="text/javascript" src="//www.redhat.com/dtm.js"></script>
<!-- <meta class="swiftype" name="published_at" data-type="date" content="2017-12-13" /> -->
<meta class="swiftype" name="version" data-type="string" content="2.9">

<!-- Google Tag Manager Data Layer -->
<script>
 dataLayer = [];
</script>
<!-- End Google Tag Manager Data Layer -->

<script src="//cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script> 
</head>

<body class="wy-body-for-nav">
   <!---- extra body elements for Ansible beyond RTD Sphinx Theme --->
<!-- Google Tag Manager -->
<noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-PSB293" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-PSB293');</script>
<!-- End Google Tag Manager -->

  <div class="DocSite-globalNav ansibleNav">
      <ul>
          <li><a href="https://www.ansible.com/ansiblefest" target="_blank">AnsibleFest</a></li>
          <li><a href="https://www.ansible.com/tower" target="_blank">Products</a></li>
          <li><a href="https://www.ansible.com/community" target="_blank">Community</a></li>
          <li><a href="https://www.ansible.com/webinars-training" target="_blank">Webinars & Training</a></li>
          <li><a href="https://www.ansible.com/blog" target="_blank">Blog</a></li>
      </ul>
  </div>

<a class="DocSite-nav" href="/" style="padding-bottom: 30px;">

  <img class="DocSiteNav-logo"
    src="../_static/images/logo_invert.png"
    alt="Ansible Logo">
  <div class="DocSiteNav-title">
    Documentation
  </div>
</a> 
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> Ansible
          

          
          </a>

          
            
            
              <div class="version">
                2.9
              </div>
            
          

          <!--- Based on https://github.com/rtfd/sphinx_rtd_theme/pull/438/files -->

<div class="version">
  
    <div class="version-dropdown">
      <select class="version-list" id="version-list" onchange="javascript:location.href = this.value;">
        <script> x = document.getElementById("version-list"); </script>
        
          <script>
            current_url = window.location.href;
            option = document.createElement("option");
            option.text = "latest";
            if ( "latest" == "2.9" ) {
              option.selected = true;
            }
            if (current_url.search("2.9") > -1) {
              option.value = current_url.replace("2.9","latest");
            } else {
              option.value = current_url.replace("latest","latest");
            }
            x.add(option);
          </script>
        
          <script>
            current_url = window.location.href;
            option = document.createElement("option");
            option.text = "2.8";
            if ( "2.8" == "2.9" ) {
              option.selected = true;
            }
            if (current_url.search("2.9") > -1) {
              option.value = current_url.replace("2.9","2.8");
            } else {
              option.value = current_url.replace("latest","2.8");
            }
            x.add(option);
          </script>
        
          <script>
            current_url = window.location.href;
            option = document.createElement("option");
            option.text = "2.7";
            if ( "2.7" == "2.9" ) {
              option.selected = true;
            }
            if (current_url.search("2.9") > -1) {
              option.value = current_url.replace("2.9","2.7");
            } else {
              option.value = current_url.replace("latest","2.7");
            }
            x.add(option);
          </script>
        
          <script>
            current_url = window.location.href;
            option = document.createElement("option");
            option.text = "devel";
            if ( "devel" == "2.9" ) {
              option.selected = true;
            }
            if (current_url.search("2.9") > -1) {
              option.value = current_url.replace("2.9","devel");
            } else {
              option.value = current_url.replace("latest","devel");
            }
            x.add(option);
          </script>
        
      </select>
    </div>
  
</div>
          
<div role="search">
<!--  <form id="rtd-search-form" class="wy-form" action="../search.html" -->
  <form id="rtd-search-form" class="wy-form"  method="get">
    <input type="text" class="st-default-search-input" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Installation, Upgrade &amp; Configuration</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../installation_guide/index.html">Installation Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../porting_guides/porting_guides.html">Ansible Porting Guides</a></li>
</ul>
<p class="caption"><span class="caption-text">Using Ansible</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">User Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="quickstart.html">Ansible Quickstart Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="basic_concepts.html">Ansible concepts</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro_getting_started.html">Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro_inventory.html">How to build your inventory</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro_dynamic_inventory.html">Working with dynamic inventory</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro_patterns.html">Patterns: targeting hosts and groups</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro_adhoc.html">Introduction to ad-hoc commands</a></li>
<li class="toctree-l2"><a class="reference internal" href="connection_details.html">Connection methods and details</a></li>
<li class="toctree-l2"><a class="reference internal" href="command_line_tools.html">Working with command line tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="playbooks.html">Working With Playbooks</a></li>
<li class="toctree-l2"><a class="reference internal" href="become.html">Understanding privilege escalation: become</a></li>
<li class="toctree-l2"><a class="reference internal" href="vault.html">Ansible Vault</a></li>
<li class="toctree-l2"><a class="reference internal" href="modules.html">Working With Modules</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../plugins/plugins.html">Working With Plugins</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../plugins/action.html">Action Plugins</a></li>
<li class="toctree-l3"><a class="reference internal" href="../plugins/become.html">Become Plugins</a></li>
<li class="toctree-l3"><a class="reference internal" href="../plugins/cache.html">Cache Plugins</a></li>
<li class="toctree-l3"><a class="reference internal" href="../plugins/callback.html">Callback Plugins</a></li>
<li class="toctree-l3"><a class="reference internal" href="../plugins/cliconf.html">Cliconf Plugins</a></li>
<li class="toctree-l3"><a class="reference internal" href="../plugins/connection.html">Connection Plugins</a></li>
<li class="toctree-l3"><a class="reference internal" href="../plugins/httpapi.html">Httpapi Plugins</a></li>
<li class="toctree-l3"><a class="reference internal" href="../plugins/inventory.html">Inventory Plugins</a></li>
<li class="toctree-l3"><a class="reference internal" href="../plugins/lookup.html">Lookup Plugins</a></li>
<li class="toctree-l3"><a class="reference internal" href="../plugins/netconf.html">Netconf Plugins</a></li>
<li class="toctree-l3"><a class="reference internal" href="../plugins/shell.html">Shell Plugins</a></li>
<li class="toctree-l3"><a class="reference internal" href="../plugins/strategy.html">Strategy Plugins</a></li>
<li class="toctree-l3"><a class="reference internal" href="../plugins/vars.html">Vars Plugins</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Filters</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#filters-for-formatting-data">Filters For Formatting Data</a></li>
<li class="toctree-l4"><a class="reference internal" href="#forcing-variables-to-be-defined">Forcing Variables To Be Defined</a></li>
<li class="toctree-l4"><a class="reference internal" href="#defaulting-undefined-variables">Defaulting Undefined Variables</a></li>
<li class="toctree-l4"><a class="reference internal" href="#omitting-parameters">Omitting Parameters</a></li>
<li class="toctree-l4"><a class="reference internal" href="#list-filters">List Filters</a></li>
<li class="toctree-l4"><a class="reference internal" href="#set-theory-filters">Set Theory Filters</a></li>
<li class="toctree-l4"><a class="reference internal" href="#dict-filter">Dict Filter</a></li>
<li class="toctree-l4"><a class="reference internal" href="#items2dict-filter">items2dict filter</a></li>
<li class="toctree-l4"><a class="reference internal" href="#zip-and-zip-longest-filters">zip and zip_longest filters</a></li>
<li class="toctree-l4"><a class="reference internal" href="#subelements-filter">subelements Filter</a></li>
<li class="toctree-l4"><a class="reference internal" href="#random-mac-address-filter">Random Mac Address Filter</a></li>
<li class="toctree-l4"><a class="reference internal" href="#random-number-filter">Random Number Filter</a></li>
<li class="toctree-l4"><a class="reference internal" href="#shuffle-filter">Shuffle Filter</a></li>
<li class="toctree-l4"><a class="reference internal" href="#math">Math</a></li>
<li class="toctree-l4"><a class="reference internal" href="#json-query-filter">JSON Query Filter</a></li>
<li class="toctree-l4"><a class="reference internal" href="#ip-address-filter">IP address filter</a></li>
<li class="toctree-l4"><a class="reference internal" href="#network-cli-filters">Network CLI filters</a></li>
<li class="toctree-l4"><a class="reference internal" href="#network-xml-filters">Network XML filters</a></li>
<li class="toctree-l4"><a class="reference internal" href="#network-vlan-filters">Network VLAN filters</a></li>
<li class="toctree-l4"><a class="reference internal" href="#hashing-filters">Hashing filters</a></li>
<li class="toctree-l4"><a class="reference internal" href="#combining-hashes-dictionaries">Combining hashes/dictionaries</a></li>
<li class="toctree-l4"><a class="reference internal" href="#extracting-values-from-containers">Extracting values from containers</a></li>
<li class="toctree-l4"><a class="reference internal" href="#comment-filter">Comment Filter</a></li>
<li class="toctree-l4"><a class="reference internal" href="#url-split-filter">URL Split Filter</a></li>
<li class="toctree-l4"><a class="reference internal" href="#regular-expression-filters">Regular Expression Filters</a></li>
<li class="toctree-l4"><a class="reference internal" href="#kubernetes-filters">Kubernetes Filters</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id8">Other Useful Filters</a></li>
<li class="toctree-l4"><a class="reference internal" href="#combination-filters">Combination Filters</a></li>
<li class="toctree-l4"><a class="reference internal" href="#product-filters">Product Filters</a></li>
<li class="toctree-l4"><a class="reference internal" href="#debugging-filters">Debugging Filters</a></li>
<li class="toctree-l4"><a class="reference internal" href="#computer-theory-assertions">Computer Theory Assertions</a></li>
<li class="toctree-l4"><a class="reference internal" href="#human-readable">Human Readable</a></li>
<li class="toctree-l4"><a class="reference internal" href="#human-to-bytes">Human to Bytes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="playbooks_tests.html">Tests</a></li>
<li class="toctree-l3"><a class="reference internal" href="plugin_filtering_config.html">Plugin Filter Configuration</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="intro_bsd.html">Ansible and BSD</a></li>
<li class="toctree-l2"><a class="reference internal" href="windows.html">Windows Guides</a></li>
<li class="toctree-l2"><a class="reference internal" href="collections_using.html">Using collections</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Contributing to Ansible</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../community/index.html">Ansible Community Guide</a></li>
</ul>
<p class="caption"><span class="caption-text">Extending Ansible</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../dev_guide/index.html">Developer Guide</a></li>
</ul>
<p class="caption"><span class="caption-text">Common Ansible Scenarios</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../scenario_guides/cloud_guides.html">Public Cloud Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../scenario_guides/network_guides.html">Network Technology Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../scenario_guides/virt_guides.html">Virtualization and Containerization Guides</a></li>
</ul>
<p class="caption"><span class="caption-text">Ansible for Network Automation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../network/index.html">Ansible for Network Automation</a></li>
</ul>
<p class="caption"><span class="caption-text">Ansible Galaxy</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../galaxy/user_guide.html">Galaxy User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../galaxy/dev_guide.html">Galaxy Developer Guide</a></li>
</ul>
<p class="caption"><span class="caption-text">Reference &amp; Appendices</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../modules/modules_by_category.html">Module Index</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference_appendices/playbooks_keywords.html">Playbook Keywords</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference_appendices/common_return_values.html">Return Values</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference_appendices/config.html">Ansible Configuration Settings</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference_appendices/general_precedence.html">Controlling how Ansible behaves: precedence rules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference_appendices/YAMLSyntax.html">YAML Syntax</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference_appendices/python_3_support.html">Python 3 Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference_appendices/interpreter_discovery.html">Interpreter Discovery</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference_appendices/release_and_maintenance.html">Release and maintenance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference_appendices/test_strategies.html">Testing Strategies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dev_guide/testing/sanity/index.html">Sanity Tests</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference_appendices/faq.html">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference_appendices/glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference_appendices/module_utils.html">Ansible Reference: Module Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference_appendices/special_variables.html">Special Variables</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference_appendices/tower.html">Red Hat Ansible Tower</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference_appendices/logging.html">Logging Ansible output</a></li>
</ul>
<p class="caption"><span class="caption-text">Roadmaps</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../roadmap/index.html">Ansible Roadmap</a></li>
</ul>

            
          
        </div>
        
         <!-- extra nav elements for Ansible beyond RTD Sphinx Theme --->
<!-- changeable widget links to tower - do not change as image controlled by Ansible-->
<div id="sideBanner">
  <br/>
  <a href="https://www.ansible.com/docs-left?utm_source=docs">
    <img style="border-width:0px;" src="https://cdn2.hubspot.net/hubfs/330046/docs-graphics/ASB-docs-left-rail.png" />
  </a>
  <br/><br/><br/>
</div>
      </div>
    </nav>
  </div>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Ansible</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          
















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">User Guide</a> &raquo;</li>
        
          <li><a href="playbooks.html">Working With Playbooks</a> &raquo;</li>
        
          <li><a href="playbooks_templating.html">Templating (Jinja2)</a> &raquo;</li>
        
      <li>Filters</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            
              <!-- Ansible-specific additions for modules etc -->
                
                  <a href="https://github.com/ansible/ansible/edit/devel/docs/docsite/rst/user_guide/playbooks_filters.rst?description=%23%23%23%23%23%20SUMMARY%0A%3C!---%20Your%20description%20here%20--%3E%0A%0A%0A%23%23%23%23%23%20ISSUE%20TYPE%0A-%20Docs%20Pull%20Request%0A%0A%2Blabel:%20docsite_pr" class="fa fa-github"> Edit on GitHub</a>
                
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <!--- Based on sphinx versionwarning extension. Extension currently only works on READTHEDOCS -->
  <script>
    // Create a banner if we're not on the official docs site
    if (location.host == "docs.testing.ansible.com") {
      document.write('<div id="testing_banner_id" class="admonition important">');
      para = document.createElement('p');
      banner_text=document.createTextNode("This is a testing site. For the official docs go to https://docs.ansible.com/");
      para.appendChild(banner_text);
      element = document.getElementById('testing_banner_id');
      element.appendChild(para);
      document.write('</div>');
    }

    // Create a banner if we're not the latest version
    current_url = window.location.href;
    if ((current_url.search("latest") > -1) || (current_url.search("/2.9/") > -1)) {
     // no banner for latest release
    } else if (current_url.search("devel") > -1) {
      document.write('<div id="banner_id" class="admonition caution">');
      para = document.createElement('p');
      banner_text=document.createTextNode("You are reading the *devel* version of the Ansible documentation - this version is not guaranteed stable. Use the version selection to the left if you want the latest stable released version.");
      para.appendChild(banner_text);
      element = document.getElementById('banner_id');
      element.appendChild(para);
      document.write('</div>');
    } else {
      document.write('<div id="banner_id" class="admonition caution">');
      para = document.createElement('p');
      banner_text=document.createTextNode("You are reading an older version of the Ansible documentation. Use the version selection to the left if you want the latest stable released version.");
      para.appendChild(banner_text);
      element = document.getElementById('banner_id');
      element.appendChild(para);
      document.write('</div>');
    }
  </script>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="filters">
<span id="playbooks-filters"></span><h1><a class="toc-backref" href="#id9">Filters</a><a class="headerlink" href="#filters" title="Permalink to this headline">¶</a></h1>
<div class="contents topic" id="topics">
<p class="topic-title">Topics</p>
<ul class="simple">
<li><p><a class="reference internal" href="#filters" id="id9">Filters</a></p>
<ul>
<li><p><a class="reference internal" href="#filters-for-formatting-data" id="id10">Filters For Formatting Data</a></p></li>
<li><p><a class="reference internal" href="#forcing-variables-to-be-defined" id="id11">Forcing Variables To Be Defined</a></p></li>
<li><p><a class="reference internal" href="#defaulting-undefined-variables" id="id12">Defaulting Undefined Variables</a></p></li>
<li><p><a class="reference internal" href="#omitting-parameters" id="id13">Omitting Parameters</a></p></li>
<li><p><a class="reference internal" href="#list-filters" id="id14">List Filters</a></p></li>
<li><p><a class="reference internal" href="#set-theory-filters" id="id15">Set Theory Filters</a></p></li>
<li><p><a class="reference internal" href="#dict-filter" id="id16">Dict Filter</a></p></li>
<li><p><a class="reference internal" href="#items2dict-filter" id="id17">items2dict filter</a></p></li>
<li><p><a class="reference internal" href="#zip-and-zip-longest-filters" id="id18">zip and zip_longest filters</a></p></li>
<li><p><a class="reference internal" href="#subelements-filter" id="id19">subelements Filter</a></p></li>
<li><p><a class="reference internal" href="#random-mac-address-filter" id="id20">Random Mac Address Filter</a></p></li>
<li><p><a class="reference internal" href="#random-number-filter" id="id21">Random Number Filter</a></p></li>
<li><p><a class="reference internal" href="#shuffle-filter" id="id22">Shuffle Filter</a></p></li>
<li><p><a class="reference internal" href="#math" id="id23">Math</a></p></li>
<li><p><a class="reference internal" href="#json-query-filter" id="id24">JSON Query Filter</a></p></li>
<li><p><a class="reference internal" href="#ip-address-filter" id="id25">IP address filter</a></p></li>
<li><p><a class="reference internal" href="#network-cli-filters" id="id26">Network CLI filters</a></p></li>
<li><p><a class="reference internal" href="#network-xml-filters" id="id27">Network XML filters</a></p></li>
<li><p><a class="reference internal" href="#network-vlan-filters" id="id28">Network VLAN filters</a></p></li>
<li><p><a class="reference internal" href="#hashing-filters" id="id29">Hashing filters</a></p></li>
<li><p><a class="reference internal" href="#combining-hashes-dictionaries" id="id30">Combining hashes/dictionaries</a></p></li>
<li><p><a class="reference internal" href="#extracting-values-from-containers" id="id31">Extracting values from containers</a></p></li>
<li><p><a class="reference internal" href="#comment-filter" id="id32">Comment Filter</a></p></li>
<li><p><a class="reference internal" href="#url-split-filter" id="id33">URL Split Filter</a></p></li>
<li><p><a class="reference internal" href="#regular-expression-filters" id="id34">Regular Expression Filters</a></p></li>
<li><p><a class="reference internal" href="#kubernetes-filters" id="id35">Kubernetes Filters</a></p></li>
<li><p><a class="reference internal" href="#id8" id="id36">Other Useful Filters</a></p></li>
<li><p><a class="reference internal" href="#combination-filters" id="id37">Combination Filters</a></p></li>
<li><p><a class="reference internal" href="#product-filters" id="id38">Product Filters</a></p></li>
<li><p><a class="reference internal" href="#debugging-filters" id="id39">Debugging Filters</a></p></li>
<li><p><a class="reference internal" href="#computer-theory-assertions" id="id40">Computer Theory Assertions</a></p></li>
<li><p><a class="reference internal" href="#human-readable" id="id41">Human Readable</a></p></li>
<li><p><a class="reference internal" href="#human-to-bytes" id="id42">Human to Bytes</a></p></li>
</ul>
</li>
</ul>
</div>
<p>Filters in Ansible are from Jinja2, and are used for transforming data inside a template expression.  Jinja2 ships with many filters. See <a class="reference external" href="http://jinja.pocoo.org/docs/templates/#builtin-filters">builtin filters</a> in the official Jinja2 template documentation.</p>
<p>Take into account that templating happens on the Ansible controller, <strong>not</strong> on the task’s target host, so filters also execute on the controller as they manipulate local data.</p>
<p>In addition the ones provided by Jinja2, Ansible ships with its own and allows users to add their own custom filters.</p>
<div class="section" id="filters-for-formatting-data">
<span id="id1"></span><h2><a class="toc-backref" href="#id10">Filters For Formatting Data</a><a class="headerlink" href="#filters-for-formatting-data" title="Permalink to this headline">¶</a></h2>
<p>The following filters will take a data structure in a template and render it in a slightly different format.  These
are occasionally useful for debugging:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="cp">{{</span> <span class="nv">some_variable</span> <span class="o">|</span> <span class="nf">to_json</span> <span class="cp">}}</span>
<span class="cp">{{</span> <span class="nv">some_variable</span> <span class="o">|</span> <span class="nf">to_yaml</span> <span class="cp">}}</span>
</pre></div>
</div>
<p>For human readable output, you can use:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="cp">{{</span> <span class="nv">some_variable</span> <span class="o">|</span> <span class="nf">to_nice_json</span> <span class="cp">}}</span>
<span class="cp">{{</span> <span class="nv">some_variable</span> <span class="o">|</span> <span class="nf">to_nice_yaml</span> <span class="cp">}}</span>
</pre></div>
</div>
<p>It’s also possible to change the indentation of both (new in version 2.2):</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="cp">{{</span> <span class="nv">some_variable</span> <span class="o">|</span> <span class="nf">to_nice_json</span><span class="o">(</span><span class="nv">indent</span><span class="o">=</span><span class="m">2</span><span class="o">)</span> <span class="cp">}}</span>
<span class="cp">{{</span> <span class="nv">some_variable</span> <span class="o">|</span> <span class="nf">to_nice_yaml</span><span class="o">(</span><span class="nv">indent</span><span class="o">=</span><span class="m">8</span><span class="o">)</span> <span class="cp">}}</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">to_yaml</span></code> and <code class="docutils literal notranslate"><span class="pre">to_nice_yaml</span></code> filters use <a class="reference external" href="https://pyyaml.org/">PyYAML library</a> which has a default 80 symbol string length limit. That causes unexpected line break after 80th symbol (if there is a space after 80th symbol)
To avoid such behaviour and generate long lines it is possible to use <code class="docutils literal notranslate"><span class="pre">width</span></code> option:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="cp">{{</span> <span class="nv">some_variable</span> <span class="o">|</span> <span class="nf">to_yaml</span><span class="o">(</span><span class="nv">indent</span><span class="o">=</span><span class="m">8</span><span class="o">,</span> <span class="nv">width</span><span class="o">=</span><span class="m">1337</span><span class="o">)</span> <span class="cp">}}</span>
<span class="cp">{{</span> <span class="nv">some_variable</span> <span class="o">|</span> <span class="nf">to_nice_yaml</span><span class="o">(</span><span class="nv">indent</span><span class="o">=</span><span class="m">8</span><span class="o">,</span> <span class="nv">width</span><span class="o">=</span><span class="m">1337</span><span class="o">)</span> <span class="cp">}}</span>
</pre></div>
</div>
<p>While it would be nicer to use a construction like <code class="docutils literal notranslate"><span class="pre">float(&quot;inf&quot;)</span></code> instead of a hardcoded number, unfortunately the filter doesn’t support proxying Python functions.
Note that it also supports passing through other YAML parameters. Full list can be found in <a class="reference external" href="https://pyyaml.org/wiki/PyYAMLDocumentation">PyYAML documentation</a>.</p>
<p>Alternatively, you may be reading in some already formatted data:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="cp">{{</span> <span class="nv">some_variable</span> <span class="o">|</span> <span class="nf">from_json</span> <span class="cp">}}</span>
<span class="cp">{{</span> <span class="nv">some_variable</span> <span class="o">|</span> <span class="nf">from_yaml</span> <span class="cp">}}</span>
</pre></div>
</div>
<p>for example:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="nt">tasks</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">shell</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">cat /some/path/to/file.json</span>
    <span class="nt">register</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">result</span>

  <span class="p p-Indicator">-</span> <span class="nt">set_fact</span><span class="p">:</span>
      <span class="nt">myvar</span><span class="p">:</span> <span class="s">&quot;</span><span class="cp">{{</span> <span class="nv">result.stdout</span> <span class="o">|</span> <span class="nf">from_json</span> <span class="cp">}}</span><span class="s">&quot;</span>
</pre></div>
</div>
<div class="versionadded">
<p><span class="versionmodified added">New in version 2.7.</span></p>
</div>
<p>To parse multi-document yaml strings, the <code class="docutils literal notranslate"><span class="pre">from_yaml_all</span></code> filter is provided.
The <code class="docutils literal notranslate"><span class="pre">from_yaml_all</span></code> filter will return a generator of parsed yaml documents.</p>
<p>for example:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="nt">tasks</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">shell</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">cat /some/path/to/multidoc-file.yaml</span>
    <span class="nt">register</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">result</span>
  <span class="p p-Indicator">-</span> <span class="nt">debug</span><span class="p">:</span>
      <span class="nt">msg</span><span class="p">:</span> <span class="s">&#39;</span><span class="cp">{{</span> <span class="nv">item</span> <span class="cp">}}</span><span class="s">&#39;</span>
    <span class="nt">loop</span><span class="p">:</span> <span class="s">&#39;</span><span class="cp">{{</span> <span class="nv">result.stdout</span> <span class="o">|</span> <span class="nf">from_yaml_all</span> <span class="o">|</span> <span class="nf">list</span> <span class="cp">}}</span><span class="s">&#39;</span>
</pre></div>
</div>
</div>
<div class="section" id="forcing-variables-to-be-defined">
<span id="id2"></span><h2><a class="toc-backref" href="#id11">Forcing Variables To Be Defined</a><a class="headerlink" href="#forcing-variables-to-be-defined" title="Permalink to this headline">¶</a></h2>
<p>The default behavior from ansible and ansible.cfg is to fail if variables are undefined, but you can turn this off.</p>
<p>This allows an explicit check with this feature off:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="cp">{{</span> <span class="nv">variable</span> <span class="o">|</span> <span class="nf">mandatory</span> <span class="cp">}}</span>
</pre></div>
</div>
<p>The variable value will be used as is, but the template evaluation will raise an error if it is undefined.</p>
</div>
<div class="section" id="defaulting-undefined-variables">
<span id="id3"></span><h2><a class="toc-backref" href="#id12">Defaulting Undefined Variables</a><a class="headerlink" href="#defaulting-undefined-variables" title="Permalink to this headline">¶</a></h2>
<p>Jinja2 provides a useful ‘default’ filter that is often a better approach to failing if a variable is not defined:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="cp">{{</span> <span class="nv">some_variable</span> <span class="o">|</span> <span class="nf">default</span><span class="o">(</span><span class="m">5</span><span class="o">)</span> <span class="cp">}}</span>
</pre></div>
</div>
<p>In the above example, if the variable ‘some_variable’ is not defined, the value used will be 5, rather than an error
being raised.</p>
<p>If you want to use the default value when variables evaluate to false or an empty string you have to set the second parameter to
<code class="docutils literal notranslate"><span class="pre">true</span></code>:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="cp">{{</span> <span class="nv">lookup</span><span class="o">(</span><span class="s1">&#39;env&#39;</span><span class="o">,</span> <span class="s1">&#39;MY_USER&#39;</span><span class="o">)</span> <span class="o">|</span> <span class="nf">default</span><span class="o">(</span><span class="s1">&#39;admin&#39;</span><span class="o">,</span> <span class="kp">true</span><span class="o">)</span> <span class="cp">}}</span>
</pre></div>
</div>
</div>
<div class="section" id="omitting-parameters">
<span id="omitting-undefined-variables"></span><h2><a class="toc-backref" href="#id13">Omitting Parameters</a><a class="headerlink" href="#omitting-parameters" title="Permalink to this headline">¶</a></h2>
<p>As of Ansible 1.8, it is possible to use the default filter to omit module parameters using the special <cite>omit</cite> variable:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">touch files with an optional mode</span>
  <span class="nt">file</span><span class="p">:</span>
    <span class="nt">dest</span><span class="p">:</span> <span class="s">&quot;</span><span class="cp">{{</span> <span class="nv">item.path</span> <span class="cp">}}</span><span class="s">&quot;</span>
    <span class="nt">state</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">touch</span>
    <span class="nt">mode</span><span class="p">:</span> <span class="s">&quot;</span><span class="cp">{{</span> <span class="nv">item.mode</span> <span class="o">|</span> <span class="nf">default</span><span class="o">(</span><span class="nv">omit</span><span class="o">)</span> <span class="cp">}}</span><span class="s">&quot;</span>
  <span class="nt">loop</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="nt">path</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/tmp/foo</span>
    <span class="p p-Indicator">-</span> <span class="nt">path</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/tmp/bar</span>
    <span class="p p-Indicator">-</span> <span class="nt">path</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/tmp/baz</span>
      <span class="nt">mode</span><span class="p">:</span> <span class="s">&quot;0444&quot;</span>
</pre></div>
</div>
<p>For the first two files in the list, the default mode will be determined by the umask of the system as the <cite>mode=</cite>
parameter will not be sent to the file module while the final file will receive the <cite>mode=0444</cite> option.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you are “chaining” additional filters after the <code class="docutils literal notranslate"><span class="pre">default(omit)</span></code> filter, you should instead do something like this:
<code class="docutils literal notranslate"><span class="pre">&quot;{{</span> <span class="pre">foo</span> <span class="pre">|</span> <span class="pre">default(None)</span> <span class="pre">|</span> <span class="pre">some_filter</span> <span class="pre">or</span> <span class="pre">omit</span> <span class="pre">}}&quot;</span></code>. In this example, the default <code class="docutils literal notranslate"><span class="pre">None</span></code> (Python null) value will cause the
later filters to fail, which will trigger the <code class="docutils literal notranslate"><span class="pre">or</span> <span class="pre">omit</span></code> portion of the logic. Using <code class="docutils literal notranslate"><span class="pre">omit</span></code> in this manner is very specific to
the later filters you’re chaining though, so be prepared for some trial and error if you do this.</p>
</div>
</div>
<div class="section" id="list-filters">
<span id="id4"></span><h2><a class="toc-backref" href="#id14">List Filters</a><a class="headerlink" href="#list-filters" title="Permalink to this headline">¶</a></h2>
<p>These filters all operate on list variables.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 1.8.</span></p>
</div>
<p>To get the minimum value from list of numbers:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="cp">{{</span> <span class="nv">list1</span> <span class="o">|</span> <span class="nf">min</span> <span class="cp">}}</span>
</pre></div>
</div>
<p>To get the maximum value from a list of numbers:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="cp">{{</span> <span class="o">[</span><span class="m">3</span><span class="o">,</span> <span class="m">4</span><span class="o">,</span> <span class="m">2</span><span class="o">]</span> <span class="o">|</span> <span class="nf">max</span> <span class="cp">}}</span>
</pre></div>
</div>
<div class="versionadded">
<p><span class="versionmodified added">New in version 2.5.</span></p>
</div>
<p>Flatten a list (same thing the <cite>flatten</cite> lookup does):</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="cp">{{</span> <span class="o">[</span><span class="m">3</span><span class="o">,</span> <span class="o">[</span><span class="m">4</span><span class="o">,</span> <span class="m">2</span><span class="o">]</span> <span class="o">]</span> <span class="o">|</span> <span class="nf">flatten</span> <span class="cp">}}</span>
</pre></div>
</div>
<p>Flatten only the first level of a list (akin to the <cite>items</cite> lookup):</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="cp">{{</span> <span class="o">[</span><span class="m">3</span><span class="o">,</span> <span class="o">[</span><span class="m">4</span><span class="o">,</span> <span class="o">[</span><span class="m">2</span><span class="o">]]</span> <span class="o">]</span> <span class="o">|</span> <span class="nf">flatten</span><span class="o">(</span><span class="nv">levels</span><span class="o">=</span><span class="m">1</span><span class="o">)</span> <span class="cp">}}</span>
</pre></div>
</div>
</div>
<div class="section" id="set-theory-filters">
<span id="id5"></span><h2><a class="toc-backref" href="#id15">Set Theory Filters</a><a class="headerlink" href="#set-theory-filters" title="Permalink to this headline">¶</a></h2>
<p>All these functions return a unique set from sets or lists.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 1.4.</span></p>
</div>
<p>To get a unique set from a list:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="cp">{{</span> <span class="nv">list1</span> <span class="o">|</span> <span class="nf">unique</span> <span class="cp">}}</span>
</pre></div>
</div>
<p>To get a union of two lists:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="cp">{{</span> <span class="nv">list1</span> <span class="o">|</span> <span class="nf">union</span><span class="o">(</span><span class="nv">list2</span><span class="o">)</span> <span class="cp">}}</span>
</pre></div>
</div>
<p>To get the intersection of 2 lists (unique list of all items in both):</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="cp">{{</span> <span class="nv">list1</span> <span class="o">|</span> <span class="nf">intersect</span><span class="o">(</span><span class="nv">list2</span><span class="o">)</span> <span class="cp">}}</span>
</pre></div>
</div>
<p>To get the difference of 2 lists (items in 1 that don’t exist in 2):</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="cp">{{</span> <span class="nv">list1</span> <span class="o">|</span> <span class="nf">difference</span><span class="o">(</span><span class="nv">list2</span><span class="o">)</span> <span class="cp">}}</span>
</pre></div>
</div>
<p>To get the symmetric difference of 2 lists (items exclusive to each list):</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="cp">{{</span> <span class="nv">list1</span> <span class="o">|</span> <span class="nf">symmetric_difference</span><span class="o">(</span><span class="nv">list2</span><span class="o">)</span> <span class="cp">}}</span>
</pre></div>
</div>
</div>
<div class="section" id="dict-filter">
<span id="id6"></span><h2><a class="toc-backref" href="#id16">Dict Filter</a><a class="headerlink" href="#dict-filter" title="Permalink to this headline">¶</a></h2>
<div class="versionadded">
<p><span class="versionmodified added">New in version 2.6.</span></p>
</div>
<p>To turn a dictionary into a list of items, suitable for looping, use <cite>dict2items</cite>:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="cp">{{</span> <span class="nv">dict</span> <span class="o">|</span> <span class="nf">dict2items</span> <span class="cp">}}</span>
</pre></div>
</div>
<p>Which turns:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="nt">tags</span><span class="p">:</span>
  <span class="nt">Application</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">payment</span>
  <span class="nt">Environment</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">dev</span>
</pre></div>
</div>
<p>into:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="nt">key</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Application</span>
  <span class="nt">value</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">payment</span>
<span class="p p-Indicator">-</span> <span class="nt">key</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Environment</span>
  <span class="nt">value</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">dev</span>
</pre></div>
</div>
<div class="versionadded">
<p><span class="versionmodified added">New in version 2.8.</span></p>
</div>
<p><code class="docutils literal notranslate"><span class="pre">dict2items</span></code> accepts 2 keyword arguments, <code class="docutils literal notranslate"><span class="pre">key_name</span></code> and <code class="docutils literal notranslate"><span class="pre">value_name</span></code> that allow configuration of the names of the keys to use for the transformation:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="cp">{{</span> <span class="nv">files</span> <span class="o">|</span> <span class="nf">dict2items</span><span class="o">(</span><span class="nv">key_name</span><span class="o">=</span><span class="s1">&#39;file&#39;</span><span class="o">,</span> <span class="nv">value_name</span><span class="o">=</span><span class="s1">&#39;path&#39;</span><span class="o">)</span> <span class="cp">}}</span>
</pre></div>
</div>
<p>Which turns:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="nt">files</span><span class="p">:</span>
  <span class="nt">users</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/etc/passwd</span>
  <span class="nt">groups</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/etc/group</span>
</pre></div>
</div>
<p>into:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="nt">file</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">users</span>
  <span class="nt">path</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/etc/passwd</span>
<span class="p p-Indicator">-</span> <span class="nt">file</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">groups</span>
  <span class="nt">path</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/etc/group</span>
</pre></div>
</div>
</div>
<div class="section" id="items2dict-filter">
<h2><a class="toc-backref" href="#id17">items2dict filter</a><a class="headerlink" href="#items2dict-filter" title="Permalink to this headline">¶</a></h2>
<div class="versionadded">
<p><span class="versionmodified added">New in version 2.7.</span></p>
</div>
<p>This filter turns a list of dicts with 2 keys, into a dict, mapping the values of those keys into <code class="docutils literal notranslate"><span class="pre">key:</span> <span class="pre">value</span></code> pairs:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="cp">{{</span> <span class="nv">tags</span> <span class="o">|</span> <span class="nf">items2dict</span> <span class="cp">}}</span>
</pre></div>
</div>
<p>Which turns:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="nt">tags</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">key</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Application</span>
    <span class="nt">value</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">payment</span>
  <span class="p p-Indicator">-</span> <span class="nt">key</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Environment</span>
    <span class="nt">value</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">dev</span>
</pre></div>
</div>
<p>into:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="nt">Application</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">payment</span>
<span class="nt">Environment</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">dev</span>
</pre></div>
</div>
<p>This is the reverse of the <code class="docutils literal notranslate"><span class="pre">dict2items</span></code> filter.</p>
<p><code class="docutils literal notranslate"><span class="pre">items2dict</span></code> accepts 2 keyword arguments, <code class="docutils literal notranslate"><span class="pre">key_name</span></code> and <code class="docutils literal notranslate"><span class="pre">value_name</span></code> that allow configuration of the names of the keys to use for the transformation:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="cp">{{</span> <span class="nv">tags</span> <span class="o">|</span> <span class="nf">items2dict</span><span class="o">(</span><span class="nv">key_name</span><span class="o">=</span><span class="s1">&#39;key&#39;</span><span class="o">,</span> <span class="nv">value_name</span><span class="o">=</span><span class="s1">&#39;value&#39;</span><span class="o">)</span> <span class="cp">}}</span>
</pre></div>
</div>
</div>
<div class="section" id="zip-and-zip-longest-filters">
<span id="zip-filter"></span><h2><a class="toc-backref" href="#id18">zip and zip_longest filters</a><a class="headerlink" href="#zip-and-zip-longest-filters" title="Permalink to this headline">¶</a></h2>
<div class="versionadded">
<p><span class="versionmodified added">New in version 2.3.</span></p>
</div>
<p>To get a list combining the elements of other lists use <code class="docutils literal notranslate"><span class="pre">zip</span></code>:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">give me list combo of two lists</span>
  <span class="nt">debug</span><span class="p">:</span>
   <span class="nt">msg</span><span class="p">:</span> <span class="s">&quot;</span><span class="cp">{{</span> <span class="o">[</span><span class="m">1</span><span class="o">,</span><span class="m">2</span><span class="o">,</span><span class="m">3</span><span class="o">,</span><span class="m">4</span><span class="o">,</span><span class="m">5</span><span class="o">]</span> <span class="o">|</span> <span class="nf">zip</span><span class="o">([</span><span class="s1">&#39;a&#39;</span><span class="o">,</span><span class="s1">&#39;b&#39;</span><span class="o">,</span><span class="s1">&#39;c&#39;</span><span class="o">,</span><span class="s1">&#39;d&#39;</span><span class="o">,</span><span class="s1">&#39;e&#39;</span><span class="o">,</span><span class="s1">&#39;f&#39;</span><span class="o">])</span> <span class="o">|</span> <span class="nf">list</span> <span class="cp">}}</span><span class="s">&quot;</span>

<span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">give me shortest combo of two lists</span>
  <span class="nt">debug</span><span class="p">:</span>
    <span class="nt">msg</span><span class="p">:</span> <span class="s">&quot;</span><span class="cp">{{</span> <span class="o">[</span><span class="m">1</span><span class="o">,</span><span class="m">2</span><span class="o">,</span><span class="m">3</span><span class="o">]</span> <span class="o">|</span> <span class="nf">zip</span><span class="o">([</span><span class="s1">&#39;a&#39;</span><span class="o">,</span><span class="s1">&#39;b&#39;</span><span class="o">,</span><span class="s1">&#39;c&#39;</span><span class="o">,</span><span class="s1">&#39;d&#39;</span><span class="o">,</span><span class="s1">&#39;e&#39;</span><span class="o">,</span><span class="s1">&#39;f&#39;</span><span class="o">])</span> <span class="o">|</span> <span class="nf">list</span> <span class="cp">}}</span><span class="s">&quot;</span>
</pre></div>
</div>
<p>To always exhaust all list use <code class="docutils literal notranslate"><span class="pre">zip_longest</span></code>:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">give me longest combo of three lists , fill with X</span>
  <span class="nt">debug</span><span class="p">:</span>
    <span class="nt">msg</span><span class="p">:</span> <span class="s">&quot;</span><span class="cp">{{</span> <span class="o">[</span><span class="m">1</span><span class="o">,</span><span class="m">2</span><span class="o">,</span><span class="m">3</span><span class="o">]</span> <span class="o">|</span> <span class="nf">zip_longest</span><span class="o">([</span><span class="s1">&#39;a&#39;</span><span class="o">,</span><span class="s1">&#39;b&#39;</span><span class="o">,</span><span class="s1">&#39;c&#39;</span><span class="o">,</span><span class="s1">&#39;d&#39;</span><span class="o">,</span><span class="s1">&#39;e&#39;</span><span class="o">,</span><span class="s1">&#39;f&#39;</span><span class="o">],</span> <span class="o">[</span><span class="m">21</span><span class="o">,</span> <span class="m">22</span><span class="o">,</span> <span class="m">23</span><span class="o">],</span> <span class="nv">fillvalue</span><span class="o">=</span><span class="s1">&#39;X&#39;</span><span class="o">)</span> <span class="o">|</span> <span class="nf">list</span> <span class="cp">}}</span><span class="s">&quot;</span>
</pre></div>
</div>
<p>Similarly to the output of the <code class="docutils literal notranslate"><span class="pre">items2dict</span></code> filter mentioned above, these filters can be used to construct a <code class="docutils literal notranslate"><span class="pre">dict</span></code>:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="cp">{{</span> <span class="nv">dict</span><span class="o">(</span><span class="nv">keys_list</span> <span class="o">|</span> <span class="nf">zip</span><span class="o">(</span><span class="nv">values_list</span><span class="o">))</span> <span class="cp">}}</span>
</pre></div>
</div>
<p>Which turns:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="nt">keys_list</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">one</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">two</span>
<span class="nt">values_list</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">apple</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">orange</span>
</pre></div>
</div>
<p>into:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="nt">one</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">apple</span>
<span class="nt">two</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">orange</span>
</pre></div>
</div>
</div>
<div class="section" id="subelements-filter">
<h2><a class="toc-backref" href="#id19">subelements Filter</a><a class="headerlink" href="#subelements-filter" title="Permalink to this headline">¶</a></h2>
<div class="versionadded">
<p><span class="versionmodified added">New in version 2.7.</span></p>
</div>
<p>Produces a product of an object, and subelement values of that object, similar to the <code class="docutils literal notranslate"><span class="pre">subelements</span></code> lookup:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="cp">{{</span> <span class="nv">users</span> <span class="o">|</span> <span class="nf">subelements</span><span class="o">(</span><span class="s1">&#39;groups&#39;</span><span class="o">,</span> <span class="nv">skip_missing</span><span class="o">=</span><span class="kp">True</span><span class="o">)</span> <span class="cp">}}</span>
</pre></div>
</div>
<p>Which turns:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="nt">users</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">alice</span>
  <span class="nt">authorized</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">/tmp/alice/onekey.pub</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">/tmp/alice/twokey.pub</span>
  <span class="nt">groups</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">wheel</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">docker</span>
<span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">bob</span>
  <span class="nt">authorized</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">/tmp/bob/id_rsa.pub</span>
  <span class="nt">groups</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">docker</span>
</pre></div>
</div>
<p>Into:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">alice</span>
    <span class="nt">groups</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">wheel</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">docker</span>
    <span class="nt">authorized</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">/tmp/alice/onekey.pub</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">/tmp/alice/twokey.pub</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">wheel</span>
<span class="p p-Indicator">-</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">alice</span>
    <span class="nt">groups</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">wheel</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">docker</span>
    <span class="nt">authorized</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">/tmp/alice/onekey.pub</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">/tmp/alice/twokey.pub</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">docker</span>
<span class="p p-Indicator">-</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">bob</span>
    <span class="nt">authorized</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">/tmp/bob/id_rsa.pub</span>
    <span class="nt">groups</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">docker</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">docker</span>
</pre></div>
</div>
<p>An example of using this filter with <code class="docutils literal notranslate"><span class="pre">loop</span></code>:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Set authorized ssh key, extracting just that data from &#39;users&#39;</span>
  <span class="nt">authorized_key</span><span class="p">:</span>
    <span class="nt">user</span><span class="p">:</span> <span class="s">&quot;</span><span class="cp">{{</span> <span class="nv">item.0.name</span> <span class="cp">}}</span><span class="s">&quot;</span>
    <span class="nt">key</span><span class="p">:</span> <span class="s">&quot;</span><span class="cp">{{</span> <span class="nv">lookup</span><span class="o">(</span><span class="s1">&#39;file&#39;</span><span class="o">,</span> <span class="nv">item.1</span><span class="o">)</span> <span class="cp">}}</span><span class="s">&quot;</span>
  <span class="nt">loop</span><span class="p">:</span> <span class="s">&quot;</span><span class="cp">{{</span> <span class="nv">users</span> <span class="o">|</span> <span class="nf">subelements</span><span class="o">(</span><span class="s1">&#39;authorized&#39;</span><span class="o">)</span> <span class="cp">}}</span><span class="s">&quot;</span>
</pre></div>
</div>
</div>
<div class="section" id="random-mac-address-filter">
<span id="random-mac-filter"></span><h2><a class="toc-backref" href="#id20">Random Mac Address Filter</a><a class="headerlink" href="#random-mac-address-filter" title="Permalink to this headline">¶</a></h2>
<div class="versionadded">
<p><span class="versionmodified added">New in version 2.6.</span></p>
</div>
<p>This filter can be used to generate a random MAC address from a string prefix.</p>
<p>To get a random MAC address from a string prefix starting with ‘52:54:00’:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="s">&quot;</span><span class="cp">{{</span> <span class="s1">&#39;52:54:00&#39;</span> <span class="o">|</span> <span class="nf">random_mac</span> <span class="cp">}}</span><span class="s">&quot;</span>
<span class="c1"># =&gt; &#39;52:54:00:ef:1c:03&#39;</span>
</pre></div>
</div>
<p>Note that if anything is wrong with the prefix string, the filter will issue an error.</p>
<p>As of Ansible version 2.9, it’s also possible to initialize the random number generator from a seed. This way, you can create random-but-idempotent MAC addresses:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="s">&quot;</span><span class="cp">{{</span> <span class="s1">&#39;52:54:00&#39;</span> <span class="o">|</span> <span class="nf">random_mac</span><span class="o">(</span><span class="nv">seed</span><span class="o">=</span><span class="nv">inventory_hostname</span><span class="o">)</span> <span class="cp">}}</span><span class="s">&quot;</span>
</pre></div>
</div>
</div>
<div class="section" id="random-number-filter">
<span id="random-filter"></span><h2><a class="toc-backref" href="#id21">Random Number Filter</a><a class="headerlink" href="#random-number-filter" title="Permalink to this headline">¶</a></h2>
<div class="versionadded">
<p><span class="versionmodified added">New in version 1.6.</span></p>
</div>
<p>This filter can be used similar to the default jinja2 random filter (returning a random item from a sequence of
items), but can also generate a random number based on a range.</p>
<p>To get a random item from a list:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="s">&quot;</span><span class="cp">{{</span> <span class="o">[</span><span class="s1">&#39;a&#39;</span><span class="o">,</span><span class="s1">&#39;b&#39;</span><span class="o">,</span><span class="s1">&#39;c&#39;</span><span class="o">]</span> <span class="o">|</span> <span class="nf">random</span> <span class="cp">}}</span><span class="s">&quot;</span>
<span class="c1"># =&gt; &#39;c&#39;</span>
</pre></div>
</div>
<p>To get a random number between 0 and a specified number:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="s">&quot;</span><span class="cp">{{</span> <span class="m">60</span> <span class="o">|</span> <span class="nf">random</span> <span class="cp">}}</span><span class="nv"> </span><span class="s">*</span><span class="nv"> </span><span class="s">*</span><span class="nv"> </span><span class="s">*</span><span class="nv"> </span><span class="s">*</span><span class="nv"> </span><span class="s">root</span><span class="nv"> </span><span class="s">/script/from/cron&quot;</span>
<span class="c1"># =&gt; &#39;21 * * * * root /script/from/cron&#39;</span>
</pre></div>
</div>
<p>Get a random number from 0 to 100 but in steps of 10:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="cp">{{</span> <span class="m">101</span> <span class="o">|</span> <span class="nf">random</span><span class="o">(</span><span class="nv">step</span><span class="o">=</span><span class="m">10</span><span class="o">)</span> <span class="cp">}}</span>
<span class="c1"># =&gt; 70</span>
</pre></div>
</div>
<p>Get a random number from 1 to 100 but in steps of 10:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="cp">{{</span> <span class="m">101</span> <span class="o">|</span> <span class="nf">random</span><span class="o">(</span><span class="m">1</span><span class="o">,</span> <span class="m">10</span><span class="o">)</span> <span class="cp">}}</span>
<span class="c1"># =&gt; 31</span>
<span class="cp">{{</span> <span class="m">101</span> <span class="o">|</span> <span class="nf">random</span><span class="o">(</span><span class="nv">start</span><span class="o">=</span><span class="m">1</span><span class="o">,</span> <span class="nv">step</span><span class="o">=</span><span class="m">10</span><span class="o">)</span> <span class="cp">}}</span>
<span class="c1"># =&gt; 51</span>
</pre></div>
</div>
<p>As of Ansible version 2.3, it’s also possible to initialize the random number generator from a seed. This way, you can create random-but-idempotent numbers:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="s">&quot;</span><span class="cp">{{</span> <span class="m">60</span> <span class="o">|</span> <span class="nf">random</span><span class="o">(</span><span class="nv">seed</span><span class="o">=</span><span class="nv">inventory_hostname</span><span class="o">)</span> <span class="cp">}}</span><span class="nv"> </span><span class="s">*</span><span class="nv"> </span><span class="s">*</span><span class="nv"> </span><span class="s">*</span><span class="nv"> </span><span class="s">*</span><span class="nv"> </span><span class="s">root</span><span class="nv"> </span><span class="s">/script/from/cron&quot;</span>
</pre></div>
</div>
</div>
<div class="section" id="shuffle-filter">
<h2><a class="toc-backref" href="#id22">Shuffle Filter</a><a class="headerlink" href="#shuffle-filter" title="Permalink to this headline">¶</a></h2>
<div class="versionadded">
<p><span class="versionmodified added">New in version 1.8.</span></p>
</div>
<p>This filter will randomize an existing list, giving a different order every invocation.</p>
<p>To get a random list from an existing  list:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="cp">{{</span> <span class="o">[</span><span class="s1">&#39;a&#39;</span><span class="o">,</span><span class="s1">&#39;b&#39;</span><span class="o">,</span><span class="s1">&#39;c&#39;</span><span class="o">]</span> <span class="o">|</span> <span class="nf">shuffle</span> <span class="cp">}}</span>
<span class="c1"># =&gt; [&#39;c&#39;,&#39;a&#39;,&#39;b&#39;]</span>
<span class="cp">{{</span> <span class="o">[</span><span class="s1">&#39;a&#39;</span><span class="o">,</span><span class="s1">&#39;b&#39;</span><span class="o">,</span><span class="s1">&#39;c&#39;</span><span class="o">]</span> <span class="o">|</span> <span class="nf">shuffle</span> <span class="cp">}}</span>
<span class="c1"># =&gt; [&#39;b&#39;,&#39;c&#39;,&#39;a&#39;]</span>
</pre></div>
</div>
<p>As of Ansible version 2.3, it’s also possible to shuffle a list idempotent. All you need is a seed.:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="cp">{{</span> <span class="o">[</span><span class="s1">&#39;a&#39;</span><span class="o">,</span><span class="s1">&#39;b&#39;</span><span class="o">,</span><span class="s1">&#39;c&#39;</span><span class="o">]</span> <span class="o">|</span> <span class="nf">shuffle</span><span class="o">(</span><span class="nv">seed</span><span class="o">=</span><span class="nv">inventory_hostname</span><span class="o">)</span> <span class="cp">}}</span>
<span class="c1"># =&gt; [&#39;b&#39;,&#39;a&#39;,&#39;c&#39;]</span>
</pre></div>
</div>
<p>note that when used with a non ‘listable’ item it is a noop, otherwise it always returns a list</p>
</div>
<div class="section" id="math">
<span id="math-stuff"></span><h2><a class="toc-backref" href="#id23">Math</a><a class="headerlink" href="#math" title="Permalink to this headline">¶</a></h2>
<div class="versionadded">
<p><span class="versionmodified added">New in version 1.9.</span></p>
</div>
<p>Get the logarithm (default is e):</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="cp">{{</span> <span class="nv">myvar</span> <span class="o">|</span> <span class="nf">log</span> <span class="cp">}}</span>
</pre></div>
</div>
<p>Get the base 10 logarithm:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="cp">{{</span> <span class="nv">myvar</span> <span class="o">|</span> <span class="nf">log</span><span class="o">(</span><span class="m">10</span><span class="o">)</span> <span class="cp">}}</span>
</pre></div>
</div>
<p>Give me the power of 2! (or 5):</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="cp">{{</span> <span class="nv">myvar</span> <span class="o">|</span> <span class="nf">pow</span><span class="o">(</span><span class="m">2</span><span class="o">)</span> <span class="cp">}}</span>
<span class="cp">{{</span> <span class="nv">myvar</span> <span class="o">|</span> <span class="nf">pow</span><span class="o">(</span><span class="m">5</span><span class="o">)</span> <span class="cp">}}</span>
</pre></div>
</div>
<p>Square root, or the 5th:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="cp">{{</span> <span class="nv">myvar</span> <span class="o">|</span> <span class="nf">root</span> <span class="cp">}}</span>
<span class="cp">{{</span> <span class="nv">myvar</span> <span class="o">|</span> <span class="nf">root</span><span class="o">(</span><span class="m">5</span><span class="o">)</span> <span class="cp">}}</span>
</pre></div>
</div>
<p>Note that jinja2 already provides some like abs() and round().</p>
</div>
<div class="section" id="json-query-filter">
<h2><a class="toc-backref" href="#id24">JSON Query Filter</a><a class="headerlink" href="#json-query-filter" title="Permalink to this headline">¶</a></h2>
<div class="versionadded">
<p><span class="versionmodified added">New in version 2.2.</span></p>
</div>
<p>Sometimes you end up with a complex data structure in JSON format and you need to extract only a small set of data within it. The <strong>json_query</strong> filter lets you query a complex JSON structure and iterate over it using a loop structure.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This filter is built upon <strong>jmespath</strong>, and you can use the same syntax. For examples, see <a class="reference external" href="http://jmespath.org/examples.html">jmespath examples</a>.</p>
</div>
<p>Now, let’s take the following data structure:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">{</span>
    <span class="s">&quot;domain_definition&quot;</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">{</span>
        <span class="s">&quot;domain&quot;</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">{</span>
            <span class="s">&quot;cluster&quot;</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">[</span>
                <span class="p p-Indicator">{</span>
                    <span class="s">&quot;name&quot;</span><span class="p p-Indicator">:</span> <span class="s">&quot;cluster1&quot;</span>
                <span class="p p-Indicator">},</span>
                <span class="p p-Indicator">{</span>
                    <span class="s">&quot;name&quot;</span><span class="p p-Indicator">:</span> <span class="s">&quot;cluster2&quot;</span>
                <span class="p p-Indicator">}</span>
            <span class="p p-Indicator">],</span>
            <span class="s">&quot;server&quot;</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">[</span>
                <span class="p p-Indicator">{</span>
                    <span class="s">&quot;name&quot;</span><span class="p p-Indicator">:</span> <span class="s">&quot;server11&quot;</span><span class="p p-Indicator">,</span>
                    <span class="s">&quot;cluster&quot;</span><span class="p p-Indicator">:</span> <span class="s">&quot;cluster1&quot;</span><span class="p p-Indicator">,</span>
                    <span class="s">&quot;port&quot;</span><span class="p p-Indicator">:</span> <span class="s">&quot;8080&quot;</span>
                <span class="p p-Indicator">},</span>
                <span class="p p-Indicator">{</span>
                    <span class="s">&quot;name&quot;</span><span class="p p-Indicator">:</span> <span class="s">&quot;server12&quot;</span><span class="p p-Indicator">,</span>
                    <span class="s">&quot;cluster&quot;</span><span class="p p-Indicator">:</span> <span class="s">&quot;cluster1&quot;</span><span class="p p-Indicator">,</span>
                    <span class="s">&quot;port&quot;</span><span class="p p-Indicator">:</span> <span class="s">&quot;8090&quot;</span>
                <span class="p p-Indicator">},</span>
                <span class="p p-Indicator">{</span>
                    <span class="s">&quot;name&quot;</span><span class="p p-Indicator">:</span> <span class="s">&quot;server21&quot;</span><span class="p p-Indicator">,</span>
                    <span class="s">&quot;cluster&quot;</span><span class="p p-Indicator">:</span> <span class="s">&quot;cluster2&quot;</span><span class="p p-Indicator">,</span>
                    <span class="s">&quot;port&quot;</span><span class="p p-Indicator">:</span> <span class="s">&quot;9080&quot;</span>
                <span class="p p-Indicator">},</span>
                <span class="p p-Indicator">{</span>
                    <span class="s">&quot;name&quot;</span><span class="p p-Indicator">:</span> <span class="s">&quot;server22&quot;</span><span class="p p-Indicator">,</span>
                    <span class="s">&quot;cluster&quot;</span><span class="p p-Indicator">:</span> <span class="s">&quot;cluster2&quot;</span><span class="p p-Indicator">,</span>
                    <span class="s">&quot;port&quot;</span><span class="p p-Indicator">:</span> <span class="s">&quot;9090&quot;</span>
                <span class="p p-Indicator">}</span>
            <span class="p p-Indicator">],</span>
            <span class="s">&quot;library&quot;</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">[</span>
                <span class="p p-Indicator">{</span>
                    <span class="s">&quot;name&quot;</span><span class="p p-Indicator">:</span> <span class="s">&quot;lib1&quot;</span><span class="p p-Indicator">,</span>
                    <span class="s">&quot;target&quot;</span><span class="p p-Indicator">:</span> <span class="s">&quot;cluster1&quot;</span>
                <span class="p p-Indicator">},</span>
                <span class="p p-Indicator">{</span>
                    <span class="s">&quot;name&quot;</span><span class="p p-Indicator">:</span> <span class="s">&quot;lib2&quot;</span><span class="p p-Indicator">,</span>
                    <span class="s">&quot;target&quot;</span><span class="p p-Indicator">:</span> <span class="s">&quot;cluster2&quot;</span>
                <span class="p p-Indicator">}</span>
            <span class="p p-Indicator">]</span>
        <span class="p p-Indicator">}</span>
    <span class="p p-Indicator">}</span>
<span class="p p-Indicator">}</span>
</pre></div>
</div>
<p>To extract all clusters from this structure, you can use the following query:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="s">&quot;Display</span><span class="nv"> </span><span class="s">all</span><span class="nv"> </span><span class="s">cluster</span><span class="nv"> </span><span class="s">names&quot;</span>
  <span class="nt">debug</span><span class="p">:</span>
    <span class="nt">var</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">item</span>
  <span class="nt">loop</span><span class="p">:</span> <span class="s">&quot;</span><span class="cp">{{</span> <span class="nv">domain_definition</span> <span class="o">|</span> <span class="nf">json_query</span><span class="o">(</span><span class="s1">&#39;domain.cluster[*].name&#39;</span><span class="o">)</span> <span class="cp">}}</span><span class="s">&quot;</span>
</pre></div>
</div>
<p>Same thing for all server names:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="s">&quot;Display</span><span class="nv"> </span><span class="s">all</span><span class="nv"> </span><span class="s">server</span><span class="nv"> </span><span class="s">names&quot;</span>
  <span class="nt">debug</span><span class="p">:</span>
    <span class="nt">var</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">item</span>
  <span class="nt">loop</span><span class="p">:</span> <span class="s">&quot;</span><span class="cp">{{</span> <span class="nv">domain_definition</span> <span class="o">|</span> <span class="nf">json_query</span><span class="o">(</span><span class="s1">&#39;domain.server[*].name&#39;</span><span class="o">)</span> <span class="cp">}}</span><span class="s">&quot;</span>
</pre></div>
</div>
<p>This example shows ports from cluster1:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="s">&quot;Display</span><span class="nv"> </span><span class="s">all</span><span class="nv"> </span><span class="s">ports</span><span class="nv"> </span><span class="s">from</span><span class="nv"> </span><span class="s">cluster1&quot;</span>
  <span class="nt">debug</span><span class="p">:</span>
    <span class="nt">var</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">item</span>
  <span class="nt">loop</span><span class="p">:</span> <span class="s">&quot;</span><span class="cp">{{</span> <span class="nv">domain_definition</span> <span class="o">|</span> <span class="nf">json_query</span><span class="o">(</span><span class="nv">server_name_cluster1_query</span><span class="o">)</span> <span class="cp">}}</span><span class="s">&quot;</span>
  <span class="nt">vars</span><span class="p">:</span>
    <span class="nt">server_name_cluster1_query</span><span class="p">:</span> <span class="s">&quot;domain.server[?cluster==&#39;cluster1&#39;].port&quot;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You can use a variable to make the query more readable.</p>
</div>
<p>Or, alternatively print out the ports in a comma separated string:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="s">&quot;Display</span><span class="nv"> </span><span class="s">all</span><span class="nv"> </span><span class="s">ports</span><span class="nv"> </span><span class="s">from</span><span class="nv"> </span><span class="s">cluster1</span><span class="nv"> </span><span class="s">as</span><span class="nv"> </span><span class="s">a</span><span class="nv"> </span><span class="s">string&quot;</span>
  <span class="nt">debug</span><span class="p">:</span>
    <span class="nt">msg</span><span class="p">:</span> <span class="s">&quot;</span><span class="cp">{{</span> <span class="nv">domain_definition</span> <span class="o">|</span> <span class="nf">json_query</span><span class="o">(</span><span class="s1">&#39;domain.server[?cluster==`cluster1`].port&#39;</span><span class="o">)</span> <span class="o">|</span> <span class="nf">join</span><span class="o">(</span><span class="s1">&#39;, &#39;</span><span class="o">)</span> <span class="cp">}}</span><span class="s">&quot;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Here, quoting literals using backticks avoids escaping quotes and maintains readability.</p>
</div>
<p>Or, using YAML <a class="reference external" href="https://yaml.org/spec/current.html#id2534365">single quote escaping</a>:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="s">&quot;Display</span><span class="nv"> </span><span class="s">all</span><span class="nv"> </span><span class="s">ports</span><span class="nv"> </span><span class="s">from</span><span class="nv"> </span><span class="s">cluster1&quot;</span>
  <span class="nt">debug</span><span class="p">:</span>
    <span class="nt">var</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">item</span>
  <span class="nt">loop</span><span class="p">:</span> <span class="s">&quot;</span><span class="cp">{{</span> <span class="nv">domain_definition</span> <span class="o">|</span> <span class="nf">json_query</span><span class="o">(</span><span class="s1">&#39;domain.server[?cluster==&#39;&#39;cluster1&#39;&#39;].port&#39;</span><span class="o">)</span> <span class="cp">}}</span><span class="s">&quot;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Escaping single quotes within single quotes in YAML is done by doubling the single quote.</p>
</div>
<p>In this example, we get a hash map with all ports and names of a cluster:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="s">&quot;Display</span><span class="nv"> </span><span class="s">all</span><span class="nv"> </span><span class="s">server</span><span class="nv"> </span><span class="s">ports</span><span class="nv"> </span><span class="s">and</span><span class="nv"> </span><span class="s">names</span><span class="nv"> </span><span class="s">from</span><span class="nv"> </span><span class="s">cluster1&quot;</span>
  <span class="nt">debug</span><span class="p">:</span>
    <span class="nt">var</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">item</span>
  <span class="nt">loop</span><span class="p">:</span> <span class="s">&quot;</span><span class="cp">{{</span> <span class="nv">domain_definition</span> <span class="o">|</span> <span class="nf">json_query</span><span class="o">(</span><span class="nv">server_name_cluster1_query</span><span class="o">)</span> <span class="cp">}}</span><span class="s">&quot;</span>
  <span class="nt">vars</span><span class="p">:</span>
    <span class="nt">server_name_cluster1_query</span><span class="p">:</span> <span class="s">&quot;domain.server[?cluster==&#39;cluster2&#39;].{name:</span><span class="nv"> </span><span class="s">name,</span><span class="nv"> </span><span class="s">port:</span><span class="nv"> </span><span class="s">port}&quot;</span>
</pre></div>
</div>
</div>
<div class="section" id="ip-address-filter">
<span id="ipaddr-filter"></span><h2><a class="toc-backref" href="#id25">IP address filter</a><a class="headerlink" href="#ip-address-filter" title="Permalink to this headline">¶</a></h2>
<div class="versionadded">
<p><span class="versionmodified added">New in version 1.9.</span></p>
</div>
<p>To test if a string is a valid IP address:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="cp">{{</span> <span class="nv">myvar</span> <span class="o">|</span> <span class="nf">ipaddr</span> <span class="cp">}}</span>
</pre></div>
</div>
<p>You can also require a specific IP protocol version:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="cp">{{</span> <span class="nv">myvar</span> <span class="o">|</span> <span class="nf">ipv4</span> <span class="cp">}}</span>
<span class="cp">{{</span> <span class="nv">myvar</span> <span class="o">|</span> <span class="nf">ipv6</span> <span class="cp">}}</span>
</pre></div>
</div>
<p>IP address filter can also be used to extract specific information from an IP
address. For example, to get the IP address itself from a CIDR, you can use:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="cp">{{</span> <span class="s1">&#39;192.0.2.1/24&#39;</span> <span class="o">|</span> <span class="nf">ipaddr</span><span class="o">(</span><span class="s1">&#39;address&#39;</span><span class="o">)</span> <span class="cp">}}</span>
</pre></div>
</div>
<p>More information about <code class="docutils literal notranslate"><span class="pre">ipaddr</span></code> filter and complete usage guide can be found
in <a class="reference internal" href="playbooks_filters_ipaddr.html#playbooks-filters-ipaddr"><span class="std std-ref">ipaddr filter</span></a>.</p>
</div>
<div class="section" id="network-cli-filters">
<span id="network-filters"></span><h2><a class="toc-backref" href="#id26">Network CLI filters</a><a class="headerlink" href="#network-cli-filters" title="Permalink to this headline">¶</a></h2>
<div class="versionadded">
<p><span class="versionmodified added">New in version 2.4.</span></p>
</div>
<p>To convert the output of a network device CLI command into structured JSON
output, use the <code class="docutils literal notranslate"><span class="pre">parse_cli</span></code> filter:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="cp">{{</span> <span class="nv">output</span> <span class="o">|</span> <span class="nf">parse_cli</span><span class="o">(</span><span class="s1">&#39;path/to/spec&#39;</span><span class="o">)</span> <span class="cp">}}</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">parse_cli</span></code> filter will load the spec file and pass the command output
through it, returning JSON output. The YAML spec file defines how to parse the CLI output.</p>
<p>The spec file should be valid formatted YAML.  It defines how to parse the CLI
output and return JSON data.  Below is an example of a valid spec file that
will parse the output from the <code class="docutils literal notranslate"><span class="pre">show</span> <span class="pre">vlan</span></code> command.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nn">---</span>
<span class="nt">vars</span><span class="p">:</span>
  <span class="nt">vlan</span><span class="p">:</span>
    <span class="nt">vlan_id</span><span class="p">:</span> <span class="s">&quot;{{</span><span class="nv"> </span><span class="s">item.vlan_id</span><span class="nv"> </span><span class="s">}}&quot;</span>
    <span class="nt">name</span><span class="p">:</span> <span class="s">&quot;{{</span><span class="nv"> </span><span class="s">item.name</span><span class="nv"> </span><span class="s">}}&quot;</span>
    <span class="nt">enabled</span><span class="p">:</span> <span class="s">&quot;{{</span><span class="nv"> </span><span class="s">item.state</span><span class="nv"> </span><span class="s">!=</span><span class="nv"> </span><span class="s">&#39;act/lshut&#39;</span><span class="nv"> </span><span class="s">}}&quot;</span>
    <span class="nt">state</span><span class="p">:</span> <span class="s">&quot;{{</span><span class="nv"> </span><span class="s">item.state</span><span class="nv"> </span><span class="s">}}&quot;</span>

<span class="nt">keys</span><span class="p">:</span>
  <span class="nt">vlans</span><span class="p">:</span>
    <span class="nt">value</span><span class="p">:</span> <span class="s">&quot;{{</span><span class="nv"> </span><span class="s">vlan</span><span class="nv"> </span><span class="s">}}&quot;</span>
    <span class="nt">items</span><span class="p">:</span> <span class="s">&quot;^(?P&lt;vlan_id&gt;\\d+)\\s+(?P&lt;name&gt;\\w+)\\s+(?P&lt;state&gt;active|act/lshut|suspended)&quot;</span>
  <span class="nt">state_static</span><span class="p">:</span>
    <span class="nt">value</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">present</span>
</pre></div>
</div>
<p>The spec file above will return a JSON data structure that is a list of hashes
with the parsed VLAN information.</p>
<p>The same command could be parsed into a hash by using the key and values
directives.  Here is an example of how to parse the output into a hash
value using the same <code class="docutils literal notranslate"><span class="pre">show</span> <span class="pre">vlan</span></code> command.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nn">---</span>
<span class="nt">vars</span><span class="p">:</span>
  <span class="nt">vlan</span><span class="p">:</span>
    <span class="nt">key</span><span class="p">:</span> <span class="s">&quot;{{</span><span class="nv"> </span><span class="s">item.vlan_id</span><span class="nv"> </span><span class="s">}}&quot;</span>
    <span class="nt">values</span><span class="p">:</span>
      <span class="nt">vlan_id</span><span class="p">:</span> <span class="s">&quot;{{</span><span class="nv"> </span><span class="s">item.vlan_id</span><span class="nv"> </span><span class="s">}}&quot;</span>
      <span class="nt">name</span><span class="p">:</span> <span class="s">&quot;{{</span><span class="nv"> </span><span class="s">item.name</span><span class="nv"> </span><span class="s">}}&quot;</span>
      <span class="nt">enabled</span><span class="p">:</span> <span class="s">&quot;{{</span><span class="nv"> </span><span class="s">item.state</span><span class="nv"> </span><span class="s">!=</span><span class="nv"> </span><span class="s">&#39;act/lshut&#39;</span><span class="nv"> </span><span class="s">}}&quot;</span>
      <span class="nt">state</span><span class="p">:</span> <span class="s">&quot;{{</span><span class="nv"> </span><span class="s">item.state</span><span class="nv"> </span><span class="s">}}&quot;</span>

<span class="nt">keys</span><span class="p">:</span>
  <span class="nt">vlans</span><span class="p">:</span>
    <span class="nt">value</span><span class="p">:</span> <span class="s">&quot;{{</span><span class="nv"> </span><span class="s">vlan</span><span class="nv"> </span><span class="s">}}&quot;</span>
    <span class="nt">items</span><span class="p">:</span> <span class="s">&quot;^(?P&lt;vlan_id&gt;\\d+)\\s+(?P&lt;name&gt;\\w+)\\s+(?P&lt;state&gt;active|act/lshut|suspended)&quot;</span>
  <span class="nt">state_static</span><span class="p">:</span>
    <span class="nt">value</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">present</span>
</pre></div>
</div>
<p>Another common use case for parsing CLI commands is to break a large command
into blocks that can be parsed.  This can be done using the <code class="docutils literal notranslate"><span class="pre">start_block</span></code> and
<code class="docutils literal notranslate"><span class="pre">end_block</span></code> directives to break the command into blocks that can be parsed.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nn">---</span>
<span class="nt">vars</span><span class="p">:</span>
  <span class="nt">interface</span><span class="p">:</span>
    <span class="nt">name</span><span class="p">:</span> <span class="s">&quot;{{</span><span class="nv"> </span><span class="s">item[0].match[0]</span><span class="nv"> </span><span class="s">}}&quot;</span>
    <span class="nt">state</span><span class="p">:</span> <span class="s">&quot;{{</span><span class="nv"> </span><span class="s">item[1].state</span><span class="nv"> </span><span class="s">}}&quot;</span>
    <span class="nt">mode</span><span class="p">:</span> <span class="s">&quot;{{</span><span class="nv"> </span><span class="s">item[2].match[0]</span><span class="nv"> </span><span class="s">}}&quot;</span>

<span class="nt">keys</span><span class="p">:</span>
  <span class="nt">interfaces</span><span class="p">:</span>
    <span class="nt">value</span><span class="p">:</span> <span class="s">&quot;{{</span><span class="nv"> </span><span class="s">interface</span><span class="nv"> </span><span class="s">}}&quot;</span>
    <span class="nt">start_block</span><span class="p">:</span> <span class="s">&quot;^Ethernet.*$&quot;</span>
    <span class="nt">end_block</span><span class="p">:</span> <span class="s">&quot;^$&quot;</span>
    <span class="nt">items</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="s">&quot;^(?P&lt;name&gt;Ethernet\\d\\/\\d*)&quot;</span>
      <span class="p p-Indicator">-</span> <span class="s">&quot;admin</span><span class="nv"> </span><span class="s">state</span><span class="nv"> </span><span class="s">is</span><span class="nv"> </span><span class="s">(?P&lt;state&gt;.+),&quot;</span>
      <span class="p p-Indicator">-</span> <span class="s">&quot;Port</span><span class="nv"> </span><span class="s">mode</span><span class="nv"> </span><span class="s">is</span><span class="nv"> </span><span class="s">(.+)&quot;</span>
</pre></div>
</div>
<p>The example above will parse the output of <code class="docutils literal notranslate"><span class="pre">show</span> <span class="pre">interface</span></code> into a list of
hashes.</p>
<p>The network filters also support parsing the output of a CLI command using the
TextFSM library.  To parse the CLI output with TextFSM use the following
filter:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="cp">{{</span> <span class="nv">output.stdout</span><span class="o">[</span><span class="m">0</span><span class="o">]</span> <span class="o">|</span> <span class="nf">parse_cli_textfsm</span><span class="o">(</span><span class="s1">&#39;path/to/fsm&#39;</span><span class="o">)</span> <span class="cp">}}</span>
</pre></div>
</div>
<p>Use of the TextFSM filter requires the TextFSM library to be installed.</p>
</div>
<div class="section" id="network-xml-filters">
<h2><a class="toc-backref" href="#id27">Network XML filters</a><a class="headerlink" href="#network-xml-filters" title="Permalink to this headline">¶</a></h2>
<div class="versionadded">
<p><span class="versionmodified added">New in version 2.5.</span></p>
</div>
<p>To convert the XML output of a network device command into structured JSON
output, use the <code class="docutils literal notranslate"><span class="pre">parse_xml</span></code> filter:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="cp">{{</span> <span class="nv">output</span> <span class="o">|</span> <span class="nf">parse_xml</span><span class="o">(</span><span class="s1">&#39;path/to/spec&#39;</span><span class="o">)</span> <span class="cp">}}</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">parse_xml</span></code> filter will load the spec file and pass the command output
through formatted as JSON.</p>
<p>The spec file should be valid formatted YAML. It defines how to parse the XML
output and return JSON data.</p>
<p>Below is an example of a valid spec file that
will parse the output from the <code class="docutils literal notranslate"><span class="pre">show</span> <span class="pre">vlan</span> <span class="pre">|</span> <span class="pre">display</span> <span class="pre">xml</span></code> command.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nn">---</span>
<span class="nt">vars</span><span class="p">:</span>
  <span class="nt">vlan</span><span class="p">:</span>
    <span class="nt">vlan_id</span><span class="p">:</span> <span class="s">&quot;{{</span><span class="nv"> </span><span class="s">item.vlan_id</span><span class="nv"> </span><span class="s">}}&quot;</span>
    <span class="nt">name</span><span class="p">:</span> <span class="s">&quot;{{</span><span class="nv"> </span><span class="s">item.name</span><span class="nv"> </span><span class="s">}}&quot;</span>
    <span class="nt">desc</span><span class="p">:</span> <span class="s">&quot;{{</span><span class="nv"> </span><span class="s">item.desc</span><span class="nv"> </span><span class="s">}}&quot;</span>
    <span class="nt">enabled</span><span class="p">:</span> <span class="s">&quot;{{</span><span class="nv"> </span><span class="s">item.state.get(&#39;inactive&#39;)</span><span class="nv"> </span><span class="s">!=</span><span class="nv"> </span><span class="s">&#39;inactive&#39;</span><span class="nv"> </span><span class="s">}}&quot;</span>
    <span class="nt">state</span><span class="p">:</span> <span class="s">&quot;{%</span><span class="nv"> </span><span class="s">if</span><span class="nv"> </span><span class="s">item.state.get(&#39;inactive&#39;)</span><span class="nv"> </span><span class="s">==</span><span class="nv"> </span><span class="s">&#39;inactive&#39;%}</span><span class="nv"> </span><span class="s">inactive</span><span class="nv"> </span><span class="s">{%</span><span class="nv"> </span><span class="s">else</span><span class="nv"> </span><span class="s">%}</span><span class="nv"> </span><span class="s">active</span><span class="nv"> </span><span class="s">{%</span><span class="nv"> </span><span class="s">endif</span><span class="nv"> </span><span class="s">%}&quot;</span>

<span class="nt">keys</span><span class="p">:</span>
  <span class="nt">vlans</span><span class="p">:</span>
    <span class="nt">value</span><span class="p">:</span> <span class="s">&quot;{{</span><span class="nv"> </span><span class="s">vlan</span><span class="nv"> </span><span class="s">}}&quot;</span>
    <span class="nt">top</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">configuration/vlans/vlan</span>
    <span class="nt">items</span><span class="p">:</span>
      <span class="nt">vlan_id</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">vlan-id</span>
      <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">name</span>
      <span class="nt">desc</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">description</span>
      <span class="nt">state</span><span class="p">:</span> <span class="s">&quot;.[@inactive=&#39;inactive&#39;]&quot;</span>
</pre></div>
</div>
<p>The spec file above will return a JSON data structure that is a list of hashes
with the parsed VLAN information.</p>
<p>The same command could be parsed into a hash by using the key and values
directives.  Here is an example of how to parse the output into a hash
value using the same <code class="docutils literal notranslate"><span class="pre">show</span> <span class="pre">vlan</span> <span class="pre">|</span> <span class="pre">display</span> <span class="pre">xml</span></code> command.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nn">---</span>
<span class="nt">vars</span><span class="p">:</span>
  <span class="nt">vlan</span><span class="p">:</span>
    <span class="nt">key</span><span class="p">:</span> <span class="s">&quot;{{</span><span class="nv"> </span><span class="s">item.vlan_id</span><span class="nv"> </span><span class="s">}}&quot;</span>
    <span class="nt">values</span><span class="p">:</span>
        <span class="nt">vlan_id</span><span class="p">:</span> <span class="s">&quot;{{</span><span class="nv"> </span><span class="s">item.vlan_id</span><span class="nv"> </span><span class="s">}}&quot;</span>
        <span class="nt">name</span><span class="p">:</span> <span class="s">&quot;{{</span><span class="nv"> </span><span class="s">item.name</span><span class="nv"> </span><span class="s">}}&quot;</span>
        <span class="nt">desc</span><span class="p">:</span> <span class="s">&quot;{{</span><span class="nv"> </span><span class="s">item.desc</span><span class="nv"> </span><span class="s">}}&quot;</span>
        <span class="nt">enabled</span><span class="p">:</span> <span class="s">&quot;{{</span><span class="nv"> </span><span class="s">item.state.get(&#39;inactive&#39;)</span><span class="nv"> </span><span class="s">!=</span><span class="nv"> </span><span class="s">&#39;inactive&#39;</span><span class="nv"> </span><span class="s">}}&quot;</span>
        <span class="nt">state</span><span class="p">:</span> <span class="s">&quot;{%</span><span class="nv"> </span><span class="s">if</span><span class="nv"> </span><span class="s">item.state.get(&#39;inactive&#39;)</span><span class="nv"> </span><span class="s">==</span><span class="nv"> </span><span class="s">&#39;inactive&#39;%}</span><span class="nv"> </span><span class="s">inactive</span><span class="nv"> </span><span class="s">{%</span><span class="nv"> </span><span class="s">else</span><span class="nv"> </span><span class="s">%}</span><span class="nv"> </span><span class="s">active</span><span class="nv"> </span><span class="s">{%</span><span class="nv"> </span><span class="s">endif</span><span class="nv"> </span><span class="s">%}&quot;</span>

<span class="nt">keys</span><span class="p">:</span>
  <span class="nt">vlans</span><span class="p">:</span>
    <span class="nt">value</span><span class="p">:</span> <span class="s">&quot;{{</span><span class="nv"> </span><span class="s">vlan</span><span class="nv"> </span><span class="s">}}&quot;</span>
    <span class="nt">top</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">configuration/vlans/vlan</span>
    <span class="nt">items</span><span class="p">:</span>
      <span class="nt">vlan_id</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">vlan-id</span>
      <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">name</span>
      <span class="nt">desc</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">description</span>
      <span class="nt">state</span><span class="p">:</span> <span class="s">&quot;.[@inactive=&#39;inactive&#39;]&quot;</span>
</pre></div>
</div>
<p>The value of <code class="docutils literal notranslate"><span class="pre">top</span></code> is the XPath relative to the XML root node.
In the example XML output given below, the value of <code class="docutils literal notranslate"><span class="pre">top</span></code> is <code class="docutils literal notranslate"><span class="pre">configuration/vlans/vlan</span></code>,
which is an XPath expression relative to the root node (&lt;rpc-reply&gt;).
<code class="docutils literal notranslate"><span class="pre">configuration</span></code> in the value of <code class="docutils literal notranslate"><span class="pre">top</span></code> is the outer most container node, and <code class="docutils literal notranslate"><span class="pre">vlan</span></code>
is the inner-most container node.</p>
<p><code class="docutils literal notranslate"><span class="pre">items</span></code> is a dictionary of key-value pairs that map user-defined names to XPath expressions
that select elements. The Xpath expression is relative to the value of the XPath value contained in <code class="docutils literal notranslate"><span class="pre">top</span></code>.
For example, the <code class="docutils literal notranslate"><span class="pre">vlan_id</span></code> in the spec file is a user defined name and its value <code class="docutils literal notranslate"><span class="pre">vlan-id</span></code> is the
relative to the value of XPath in <code class="docutils literal notranslate"><span class="pre">top</span></code></p>
<p>Attributes of XML tags can be extracted using XPath expressions. The value of <code class="docutils literal notranslate"><span class="pre">state</span></code> in the spec
is an XPath expression used to get the attributes of the <code class="docutils literal notranslate"><span class="pre">vlan</span></code> tag in output XML.:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">&lt;rpc-reply&gt;</span>
  <span class="l l-Scalar l-Scalar-Plain">&lt;configuration&gt;</span>
    <span class="l l-Scalar l-Scalar-Plain">&lt;vlans&gt;</span>
      <span class="l l-Scalar l-Scalar-Plain">&lt;vlan inactive=&quot;inactive&quot;&gt;</span>
       <span class="l l-Scalar l-Scalar-Plain">&lt;name&gt;vlan-1&lt;/name&gt;</span>
       <span class="l l-Scalar l-Scalar-Plain">&lt;vlan-id&gt;200&lt;/vlan-id&gt;</span>
       <span class="l l-Scalar l-Scalar-Plain">&lt;description&gt;This is vlan-1&lt;/description&gt;</span>
      <span class="l l-Scalar l-Scalar-Plain">&lt;/vlan&gt;</span>
    <span class="l l-Scalar l-Scalar-Plain">&lt;/vlans&gt;</span>
  <span class="l l-Scalar l-Scalar-Plain">&lt;/configuration&gt;</span>
<span class="l l-Scalar l-Scalar-Plain">&lt;/rpc-reply&gt;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For more information on supported XPath expressions, see <a class="reference external" href="https://docs.python.org/2/library/xml.etree.elementtree.html#xpath-support">https://docs.python.org/2/library/xml.etree.elementtree.html#xpath-support</a>.</p>
</div>
</div>
<div class="section" id="network-vlan-filters">
<h2><a class="toc-backref" href="#id28">Network VLAN filters</a><a class="headerlink" href="#network-vlan-filters" title="Permalink to this headline">¶</a></h2>
<div class="versionadded">
<p><span class="versionmodified added">New in version 2.8.</span></p>
</div>
<p>Use the <code class="docutils literal notranslate"><span class="pre">vlan_parser</span></code> filter to manipulate an unsorted list of VLAN integers into a
sorted string list of integers according to IOS-like VLAN list rules. This list has the following properties:</p>
<ul class="simple">
<li><p>Vlans are listed in ascending order.</p></li>
<li><p>Three or more consecutive VLANs are listed with a dash.</p></li>
<li><p>The first line of the list can be first_line_len characters long.</p></li>
<li><p>Subsequent list lines can be other_line_len characters.</p></li>
</ul>
<p>To sort a VLAN list:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="cp">{{</span> <span class="o">[</span><span class="m">3003</span><span class="o">,</span> <span class="m">3004</span><span class="o">,</span> <span class="m">3005</span><span class="o">,</span> <span class="m">100</span><span class="o">,</span> <span class="m">1688</span><span class="o">,</span> <span class="m">3002</span><span class="o">,</span> <span class="m">3999</span><span class="o">]</span> <span class="o">|</span> <span class="nf">vlan_parser</span> <span class="cp">}}</span>
</pre></div>
</div>
<p>This example renders the following sorted list:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">[</span><span class="s">&#39;100,1688,3002-3005,3999&#39;</span><span class="p p-Indicator">]</span>
</pre></div>
</div>
<p>Another example Jinja template:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="cp">{%</span> <span class="k">set</span> <span class="nv">parsed_vlans</span> <span class="o">=</span> <span class="nv">vlans</span> <span class="o">|</span> <span class="nf">vlan_parser</span> <span class="cp">%}</span>
<span class="l l-Scalar l-Scalar-Plain">switchport trunk allowed vlan</span> <span class="cp">{{</span> <span class="nv">parsed_vlans</span><span class="o">[</span><span class="m">0</span><span class="o">]</span> <span class="cp">}}</span>
<span class="cp">{%</span> <span class="k">for</span> <span class="nv">i</span> <span class="k">in</span> <span class="nv">range</span> <span class="o">(</span><span class="m">1</span><span class="o">,</span> <span class="nv">parsed_vlans</span> <span class="o">|</span> <span class="nf">count</span><span class="o">)</span> <span class="cp">%}</span>
<span class="l l-Scalar l-Scalar-Plain">switchport trunk allowed vlan add</span> <span class="cp">{{</span> <span class="nv">parsed_vlans</span><span class="o">[</span><span class="nv">i</span><span class="o">]</span> <span class="cp">}}</span>
</pre></div>
</div>
<p>This allows for dynamic generation of VLAN lists on a Cisco IOS tagged interface. You can store an exhaustive raw list of the exact VLANs required for an interface and then compare that to the parsed IOS output that would actually be generated for the configuration.</p>
</div>
<div class="section" id="hashing-filters">
<span id="hash-filters"></span><h2><a class="toc-backref" href="#id29">Hashing filters</a><a class="headerlink" href="#hashing-filters" title="Permalink to this headline">¶</a></h2>
<div class="versionadded">
<p><span class="versionmodified added">New in version 1.9.</span></p>
</div>
<p>To get the sha1 hash of a string:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="cp">{{</span> <span class="s1">&#39;test1&#39;</span> <span class="o">|</span> <span class="nf">hash</span><span class="o">(</span><span class="s1">&#39;sha1&#39;</span><span class="o">)</span> <span class="cp">}}</span>
</pre></div>
</div>
<p>To get the md5 hash of a string:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="cp">{{</span> <span class="s1">&#39;test1&#39;</span> <span class="o">|</span> <span class="nf">hash</span><span class="o">(</span><span class="s1">&#39;md5&#39;</span><span class="o">)</span> <span class="cp">}}</span>
</pre></div>
</div>
<p>Get a string checksum:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="cp">{{</span> <span class="s1">&#39;test2&#39;</span> <span class="o">|</span> <span class="nf">checksum</span> <span class="cp">}}</span>
</pre></div>
</div>
<p>Other hashes (platform dependent):</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="cp">{{</span> <span class="s1">&#39;test2&#39;</span> <span class="o">|</span> <span class="nf">hash</span><span class="o">(</span><span class="s1">&#39;blowfish&#39;</span><span class="o">)</span> <span class="cp">}}</span>
</pre></div>
</div>
<p>To get a sha512 password hash (random salt):</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="cp">{{</span> <span class="s1">&#39;passwordsaresecret&#39;</span> <span class="o">|</span> <span class="nf">password_hash</span><span class="o">(</span><span class="s1">&#39;sha512&#39;</span><span class="o">)</span> <span class="cp">}}</span>
</pre></div>
</div>
<p>To get a sha256 password hash with a specific salt:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="cp">{{</span> <span class="s1">&#39;secretpassword&#39;</span> <span class="o">|</span> <span class="nf">password_hash</span><span class="o">(</span><span class="s1">&#39;sha256&#39;</span><span class="o">,</span> <span class="s1">&#39;mysecretsalt&#39;</span><span class="o">)</span> <span class="cp">}}</span>
</pre></div>
</div>
<p>An idempotent method to generate unique hashes per system is to use a salt that is consistent between runs:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="cp">{{</span> <span class="s1">&#39;secretpassword&#39;</span> <span class="o">|</span> <span class="nf">password_hash</span><span class="o">(</span><span class="s1">&#39;sha512&#39;</span><span class="o">,</span> <span class="m">65534</span> <span class="o">|</span> <span class="nf">random</span><span class="o">(</span><span class="nv">seed</span><span class="o">=</span><span class="nv">inventory_hostname</span><span class="o">)</span> <span class="o">|</span> <span class="nf">string</span><span class="o">)</span> <span class="cp">}}</span>
</pre></div>
</div>
<p>Hash types available depend on the master system running ansible,
‘hash’ depends on hashlib password_hash depends on passlib (<a class="reference external" href="https://passlib.readthedocs.io/en/stable/lib/passlib.hash.html">https://passlib.readthedocs.io/en/stable/lib/passlib.hash.html</a>).</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 2.7.</span></p>
</div>
<p>Some hash types allow providing a rounds parameter:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="cp">{{</span> <span class="s1">&#39;secretpassword&#39;</span> <span class="o">|</span> <span class="nf">password_hash</span><span class="o">(</span><span class="s1">&#39;sha256&#39;</span><span class="o">,</span> <span class="s1">&#39;mysecretsalt&#39;</span><span class="o">,</span> <span class="nv">rounds</span><span class="o">=</span><span class="m">10000</span><span class="o">)</span> <span class="cp">}}</span>
</pre></div>
</div>
</div>
<div class="section" id="combining-hashes-dictionaries">
<span id="combine-filter"></span><h2><a class="toc-backref" href="#id30">Combining hashes/dictionaries</a><a class="headerlink" href="#combining-hashes-dictionaries" title="Permalink to this headline">¶</a></h2>
<div class="versionadded">
<p><span class="versionmodified added">New in version 2.0.</span></p>
</div>
<p>The <cite>combine</cite> filter allows hashes to be merged. For example, the
following would override keys in one hash:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="cp">{{</span> <span class="o">{</span><span class="s1">&#39;a&#39;</span><span class="o">:</span><span class="m">1</span><span class="o">,</span> <span class="s1">&#39;b&#39;</span><span class="o">:</span><span class="m">2</span><span class="o">}</span> <span class="o">|</span> <span class="nf">combine</span><span class="o">({</span><span class="s1">&#39;b&#39;</span><span class="o">:</span><span class="m">3</span><span class="o">})</span> <span class="cp">}}</span>
</pre></div>
</div>
<p>The resulting hash would be:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">{</span><span class="s">&#39;a&#39;</span><span class="p p-Indicator">:</span><span class="nv">1</span><span class="p p-Indicator">,</span> <span class="s">&#39;b&#39;</span><span class="p p-Indicator">:</span><span class="nv">3</span><span class="p p-Indicator">}</span>
</pre></div>
</div>
<p>The filter also accepts an optional <cite>recursive=True</cite> parameter to not
only override keys in the first hash, but also recurse into nested
hashes and merge their keys too</p>
<div class="highlight-jinja notranslate"><div class="highlight"><pre><span></span><span class="cp">{{</span> <span class="o">{</span><span class="s1">&#39;a&#39;</span><span class="o">:{</span><span class="s1">&#39;foo&#39;</span><span class="o">:</span><span class="m">1</span><span class="o">,</span> <span class="s1">&#39;bar&#39;</span><span class="o">:</span><span class="m">2</span><span class="o">},</span> <span class="s1">&#39;b&#39;</span><span class="o">:</span><span class="m">2</span><span class="o">}</span> <span class="o">|</span> <span class="nf">combine</span><span class="o">({</span><span class="s1">&#39;a&#39;</span><span class="o">:{</span><span class="s1">&#39;bar&#39;</span><span class="o">:</span><span class="m">3</span><span class="o">,</span> <span class="s1">&#39;baz&#39;</span><span class="o">:</span><span class="m">4</span><span class="cp">}}</span><span class="x">, recursive=True) }}</span>
</pre></div>
</div>
<p>This would result in:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">{</span><span class="s">&#39;a&#39;</span><span class="p p-Indicator">:{</span><span class="s">&#39;foo&#39;</span><span class="p p-Indicator">:</span><span class="nv">1</span><span class="p p-Indicator">,</span> <span class="s">&#39;bar&#39;</span><span class="p p-Indicator">:</span><span class="nv">3</span><span class="p p-Indicator">,</span> <span class="s">&#39;baz&#39;</span><span class="p p-Indicator">:</span><span class="nv">4</span><span class="p p-Indicator">},</span> <span class="s">&#39;b&#39;</span><span class="p p-Indicator">:</span><span class="nv">2</span><span class="p p-Indicator">}</span>
</pre></div>
</div>
<p>The filter can also take multiple arguments to merge:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="cp">{{</span> <span class="nv">a</span> <span class="o">|</span> <span class="nf">combine</span><span class="o">(</span><span class="nv">b</span><span class="o">,</span> <span class="nv">c</span><span class="o">,</span> <span class="nv">d</span><span class="o">)</span> <span class="cp">}}</span>
</pre></div>
</div>
<p>In this case, keys in <cite>d</cite> would override those in <cite>c</cite>, which would
override those in <cite>b</cite>, and so on.</p>
<p>This behaviour does not depend on the value of the <cite>hash_behaviour</cite>
setting in <cite>ansible.cfg</cite>.</p>
</div>
<div class="section" id="extracting-values-from-containers">
<span id="extract-filter"></span><h2><a class="toc-backref" href="#id31">Extracting values from containers</a><a class="headerlink" href="#extracting-values-from-containers" title="Permalink to this headline">¶</a></h2>
<div class="versionadded">
<p><span class="versionmodified added">New in version 2.1.</span></p>
</div>
<p>The <cite>extract</cite> filter is used to map from a list of indices to a list of
values from a container (hash or array):</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="cp">{{</span> <span class="o">[</span><span class="m">0</span><span class="o">,</span><span class="m">2</span><span class="o">]</span> <span class="o">|</span> <span class="nf">map</span><span class="o">(</span><span class="s1">&#39;extract&#39;</span><span class="o">,</span> <span class="o">[</span><span class="s1">&#39;x&#39;</span><span class="o">,</span><span class="s1">&#39;y&#39;</span><span class="o">,</span><span class="s1">&#39;z&#39;</span><span class="o">])</span> <span class="o">|</span> <span class="nf">list</span> <span class="cp">}}</span>
<span class="cp">{{</span> <span class="o">[</span><span class="s1">&#39;x&#39;</span><span class="o">,</span><span class="s1">&#39;y&#39;</span><span class="o">]</span> <span class="o">|</span> <span class="nf">map</span><span class="o">(</span><span class="s1">&#39;extract&#39;</span><span class="o">,</span> <span class="o">{</span><span class="s1">&#39;x&#39;</span><span class="o">:</span> <span class="m">42</span><span class="o">,</span> <span class="s1">&#39;y&#39;</span><span class="o">:</span> <span class="m">31</span><span class="o">})</span> <span class="o">|</span> <span class="nf">list</span> <span class="cp">}}</span>
</pre></div>
</div>
<p>The results of the above expressions would be:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">[</span><span class="s">&#39;x&#39;</span><span class="p p-Indicator">,</span> <span class="s">&#39;z&#39;</span><span class="p p-Indicator">]</span>
<span class="p p-Indicator">[</span><span class="nv">42</span><span class="p p-Indicator">,</span> <span class="nv">31</span><span class="p p-Indicator">]</span>
</pre></div>
</div>
<p>The filter can take another argument:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="cp">{{</span> <span class="nv">groups</span><span class="o">[</span><span class="s1">&#39;x&#39;</span><span class="o">]</span> <span class="o">|</span> <span class="nf">map</span><span class="o">(</span><span class="s1">&#39;extract&#39;</span><span class="o">,</span> <span class="nv">hostvars</span><span class="o">,</span> <span class="s1">&#39;ec2_ip_address&#39;</span><span class="o">)</span> <span class="o">|</span> <span class="nf">list</span> <span class="cp">}}</span>
</pre></div>
</div>
<p>This takes the list of hosts in group ‘x’, looks them up in <cite>hostvars</cite>,
and then looks up the <cite>ec2_ip_address</cite> of the result. The final result
is a list of IP addresses for the hosts in group ‘x’.</p>
<p>The third argument to the filter can also be a list, for a recursive
lookup inside the container:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="cp">{{</span> <span class="o">[</span><span class="s1">&#39;a&#39;</span><span class="o">]</span> <span class="o">|</span> <span class="nf">map</span><span class="o">(</span><span class="s1">&#39;extract&#39;</span><span class="o">,</span> <span class="nv">b</span><span class="o">,</span> <span class="o">[</span><span class="s1">&#39;x&#39;</span><span class="o">,</span><span class="s1">&#39;y&#39;</span><span class="o">])</span> <span class="o">|</span> <span class="nf">list</span> <span class="cp">}}</span>
</pre></div>
</div>
<p>This would return a list containing the value of <cite>b[‘a’][‘x’][‘y’]</cite>.</p>
</div>
<div class="section" id="comment-filter">
<span id="id7"></span><h2><a class="toc-backref" href="#id32">Comment Filter</a><a class="headerlink" href="#comment-filter" title="Permalink to this headline">¶</a></h2>
<div class="versionadded">
<p><span class="versionmodified added">New in version 2.0.</span></p>
</div>
<p>The <cite>comment</cite> filter allows to decorate the text with a chosen comment
style. For example the following:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="cp">{{</span> <span class="s2">&quot;Plain style (default)&quot;</span> <span class="o">|</span> <span class="nf">comment</span> <span class="cp">}}</span>
</pre></div>
</div>
<p>will produce this output:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>#
# Plain style (default)
#
</pre></div>
</div>
<p>Similar way can be applied style for C (<code class="docutils literal notranslate"><span class="pre">//...</span></code>), C block
(<code class="docutils literal notranslate"><span class="pre">/*...*/</span></code>), Erlang (<code class="docutils literal notranslate"><span class="pre">%...</span></code>) and XML (<code class="docutils literal notranslate"><span class="pre">&lt;!--...--&gt;</span></code>):</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="cp">{{</span> <span class="s2">&quot;C style&quot;</span> <span class="o">|</span> <span class="nf">comment</span><span class="o">(</span><span class="s1">&#39;c&#39;</span><span class="o">)</span> <span class="cp">}}</span>
<span class="cp">{{</span> <span class="s2">&quot;C block style&quot;</span> <span class="o">|</span> <span class="nf">comment</span><span class="o">(</span><span class="s1">&#39;cblock&#39;</span><span class="o">)</span> <span class="cp">}}</span>
<span class="cp">{{</span> <span class="s2">&quot;Erlang style&quot;</span> <span class="o">|</span> <span class="nf">comment</span><span class="o">(</span><span class="s1">&#39;erlang&#39;</span><span class="o">)</span> <span class="cp">}}</span>
<span class="cp">{{</span> <span class="s2">&quot;XML style&quot;</span> <span class="o">|</span> <span class="nf">comment</span><span class="o">(</span><span class="s1">&#39;xml&#39;</span><span class="o">)</span> <span class="cp">}}</span>
</pre></div>
</div>
<p>If you need a specific comment character that is not included by any of the
above, you can customize it with:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="cp">{{</span> <span class="s2">&quot;My Special Case&quot;</span> <span class="o">|</span> <span class="nf">comment</span><span class="o">(</span><span class="nv">decoration</span><span class="o">=</span><span class="s2">&quot;! &quot;</span><span class="o">)</span> <span class="cp">}}</span>
</pre></div>
</div>
<p>producing:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>!
! My Special Case
!
</pre></div>
</div>
<p>It is also possible to fully customize the comment style:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="cp">{{</span> <span class="s2">&quot;Custom style&quot;</span> <span class="o">|</span> <span class="nf">comment</span><span class="o">(</span><span class="s1">&#39;plain&#39;</span><span class="o">,</span> <span class="nv">prefix</span><span class="o">=</span><span class="s1">&#39;#######\n#&#39;</span><span class="o">,</span> <span class="nv">postfix</span><span class="o">=</span><span class="s1">&#39;#\n#######\n   ###\n    #&#39;</span><span class="o">)</span> <span class="cp">}}</span>
</pre></div>
</div>
<p>That will create the following output:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>#######
#
# Custom style
#
#######
   ###
    #
</pre></div>
</div>
<p>The filter can also be applied to any Ansible variable. For example to
make the output of the <code class="docutils literal notranslate"><span class="pre">ansible_managed</span></code> variable more readable, we can
change the definition in the <code class="docutils literal notranslate"><span class="pre">ansible.cfg</span></code> file to this:</p>
<div class="highlight-jinja notranslate"><div class="highlight"><pre><span></span><span class="x">[defaults]</span>

<span class="x">ansible_managed = This file is managed by Ansible.%n</span>
<span class="x">  template: {file}</span>
<span class="x">  date: %Y-%m-%d %H:%M:%S</span>
<span class="x">  user: {uid}</span>
<span class="x">  host: {host}</span>
</pre></div>
</div>
<p>and then use the variable with the <cite>comment</cite> filter:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="cp">{{</span> <span class="nv">ansible_managed</span> <span class="o">|</span> <span class="nf">comment</span> <span class="cp">}}</span>
</pre></div>
</div>
<p>which will produce this output:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="c1">#</span>
<span class="c1"># This file is managed by Ansible.</span>
<span class="c1">#</span>
<span class="c1"># template: /home/ansible/env/dev/ansible_managed/roles/role1/templates/test.j2</span>
<span class="c1"># date: 2015-09-10 11:02:58</span>
<span class="c1"># user: ansible</span>
<span class="c1"># host: myhost</span>
<span class="c1">#</span>
</pre></div>
</div>
</div>
<div class="section" id="url-split-filter">
<span id="other-useful-filters"></span><h2><a class="toc-backref" href="#id33">URL Split Filter</a><a class="headerlink" href="#url-split-filter" title="Permalink to this headline">¶</a></h2>
<div class="versionadded">
<p><span class="versionmodified added">New in version 2.4.</span></p>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">urlsplit</span></code> filter extracts the fragment, hostname, netloc, password, path, port, query, scheme, and username from an URL. With no arguments, returns a dictionary of all the fields:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="cp">{{</span> <span class="s2">&quot;http://user:password@www.acme.com:9000/dir/index.html?query=term#fragment&quot;</span> <span class="o">|</span> <span class="nf">urlsplit</span><span class="o">(</span><span class="s1">&#39;hostname&#39;</span><span class="o">)</span> <span class="cp">}}</span>
<span class="c1"># =&gt; &#39;www.acme.com&#39;</span>

<span class="cp">{{</span> <span class="s2">&quot;http://user:password@www.acme.com:9000/dir/index.html?query=term#fragment&quot;</span> <span class="o">|</span> <span class="nf">urlsplit</span><span class="o">(</span><span class="s1">&#39;netloc&#39;</span><span class="o">)</span> <span class="cp">}}</span>
<span class="c1"># =&gt; &#39;user:password@www.acme.com:9000&#39;</span>

<span class="cp">{{</span> <span class="s2">&quot;http://user:password@www.acme.com:9000/dir/index.html?query=term#fragment&quot;</span> <span class="o">|</span> <span class="nf">urlsplit</span><span class="o">(</span><span class="s1">&#39;username&#39;</span><span class="o">)</span> <span class="cp">}}</span>
<span class="c1"># =&gt; &#39;user&#39;</span>

<span class="cp">{{</span> <span class="s2">&quot;http://user:password@www.acme.com:9000/dir/index.html?query=term#fragment&quot;</span> <span class="o">|</span> <span class="nf">urlsplit</span><span class="o">(</span><span class="s1">&#39;password&#39;</span><span class="o">)</span> <span class="cp">}}</span>
<span class="c1"># =&gt; &#39;password&#39;</span>

<span class="cp">{{</span> <span class="s2">&quot;http://user:password@www.acme.com:9000/dir/index.html?query=term#fragment&quot;</span> <span class="o">|</span> <span class="nf">urlsplit</span><span class="o">(</span><span class="s1">&#39;path&#39;</span><span class="o">)</span> <span class="cp">}}</span>
<span class="c1"># =&gt; &#39;/dir/index.html&#39;</span>

<span class="cp">{{</span> <span class="s2">&quot;http://user:password@www.acme.com:9000/dir/index.html?query=term#fragment&quot;</span> <span class="o">|</span> <span class="nf">urlsplit</span><span class="o">(</span><span class="s1">&#39;port&#39;</span><span class="o">)</span> <span class="cp">}}</span>
<span class="c1"># =&gt; &#39;9000&#39;</span>

<span class="cp">{{</span> <span class="s2">&quot;http://user:password@www.acme.com:9000/dir/index.html?query=term#fragment&quot;</span> <span class="o">|</span> <span class="nf">urlsplit</span><span class="o">(</span><span class="s1">&#39;scheme&#39;</span><span class="o">)</span> <span class="cp">}}</span>
<span class="c1"># =&gt; &#39;http&#39;</span>

<span class="cp">{{</span> <span class="s2">&quot;http://user:password@www.acme.com:9000/dir/index.html?query=term#fragment&quot;</span> <span class="o">|</span> <span class="nf">urlsplit</span><span class="o">(</span><span class="s1">&#39;query&#39;</span><span class="o">)</span> <span class="cp">}}</span>
<span class="c1"># =&gt; &#39;query=term&#39;</span>

<span class="cp">{{</span> <span class="s2">&quot;http://user:password@www.acme.com:9000/dir/index.html?query=term#fragment&quot;</span> <span class="o">|</span> <span class="nf">urlsplit</span><span class="o">(</span><span class="s1">&#39;fragment&#39;</span><span class="o">)</span> <span class="cp">}}</span>
<span class="c1"># =&gt; &#39;fragment&#39;</span>

<span class="cp">{{</span> <span class="s2">&quot;http://user:password@www.acme.com:9000/dir/index.html?query=term#fragment&quot;</span> <span class="o">|</span> <span class="nf">urlsplit</span> <span class="cp">}}</span>
<span class="c1"># =&gt;</span>
<span class="c1">#   {</span>
<span class="c1">#       &quot;fragment&quot;: &quot;fragment&quot;,</span>
<span class="c1">#       &quot;hostname&quot;: &quot;www.acme.com&quot;,</span>
<span class="c1">#       &quot;netloc&quot;: &quot;user:password@www.acme.com:9000&quot;,</span>
<span class="c1">#       &quot;password&quot;: &quot;password&quot;,</span>
<span class="c1">#       &quot;path&quot;: &quot;/dir/index.html&quot;,</span>
<span class="c1">#       &quot;port&quot;: 9000,</span>
<span class="c1">#       &quot;query&quot;: &quot;query=term&quot;,</span>
<span class="c1">#       &quot;scheme&quot;: &quot;http&quot;,</span>
<span class="c1">#       &quot;username&quot;: &quot;user&quot;</span>
<span class="c1">#   }</span>
</pre></div>
</div>
</div>
<div class="section" id="regular-expression-filters">
<h2><a class="toc-backref" href="#id34">Regular Expression Filters</a><a class="headerlink" href="#regular-expression-filters" title="Permalink to this headline">¶</a></h2>
<p>To search a string with a regex, use the “regex_search” filter:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="c1"># search for &quot;foo&quot; in &quot;foobar&quot;</span>
<span class="cp">{{</span> <span class="s1">&#39;foobar&#39;</span> <span class="o">|</span> <span class="nf">regex_search</span><span class="o">(</span><span class="s1">&#39;(foo)&#39;</span><span class="o">)</span> <span class="cp">}}</span>

<span class="c1"># will return empty if it cannot find a match</span>
<span class="cp">{{</span> <span class="s1">&#39;ansible&#39;</span> <span class="o">|</span> <span class="nf">regex_search</span><span class="o">(</span><span class="s1">&#39;(foobar)&#39;</span><span class="o">)</span> <span class="cp">}}</span>

<span class="c1"># case insensitive search in multiline mode</span>
<span class="cp">{{</span> <span class="s1">&#39;foo\nBAR&#39;</span> <span class="o">|</span> <span class="nf">regex_search</span><span class="o">(</span><span class="s2">&quot;^bar&quot;</span><span class="o">,</span> <span class="nv">multiline</span><span class="o">=</span><span class="kp">True</span><span class="o">,</span> <span class="nv">ignorecase</span><span class="o">=</span><span class="kp">True</span><span class="o">)</span> <span class="cp">}}</span>
</pre></div>
</div>
<p>To search for all occurrences of regex matches, use the “regex_findall” filter:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="c1"># Return a list of all IPv4 addresses in the string</span>
<span class="cp">{{</span> <span class="s1">&#39;Some DNS servers are 8.8.8.8 and 8.8.4.4&#39;</span> <span class="o">|</span> <span class="nf">regex_findall</span><span class="o">(</span><span class="s1">&#39;\\b(?:[0-9]{1,3}\\.){3}[0-9]{1,3}\\b&#39;</span><span class="o">)</span> <span class="cp">}}</span>
</pre></div>
</div>
<p>To replace text in a string with regex, use the “regex_replace” filter:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="c1"># convert &quot;ansible&quot; to &quot;able&quot;</span>
<span class="cp">{{</span> <span class="s1">&#39;ansible&#39;</span> <span class="o">|</span> <span class="nf">regex_replace</span><span class="o">(</span><span class="s1">&#39;^a.*i(.*)$&#39;</span><span class="o">,</span> <span class="s1">&#39;a\\1&#39;</span><span class="o">)</span> <span class="cp">}}</span>

<span class="c1"># convert &quot;foobar&quot; to &quot;bar&quot;</span>
<span class="cp">{{</span> <span class="s1">&#39;foobar&#39;</span> <span class="o">|</span> <span class="nf">regex_replace</span><span class="o">(</span><span class="s1">&#39;^f.*o(.*)$&#39;</span><span class="o">,</span> <span class="s1">&#39;\\1&#39;</span><span class="o">)</span> <span class="cp">}}</span>

<span class="c1"># convert &quot;localhost:80&quot; to &quot;localhost, 80&quot; using named groups</span>
<span class="cp">{{</span> <span class="s1">&#39;localhost:80&#39;</span> <span class="o">|</span> <span class="nf">regex_replace</span><span class="o">(</span><span class="s1">&#39;^(?P&lt;host&gt;.+):(?P&lt;port&gt;\\d+)$&#39;</span><span class="o">,</span> <span class="s1">&#39;\\g&lt;host&gt;, \\g&lt;port&gt;&#39;</span><span class="o">)</span> <span class="cp">}}</span>

<span class="c1"># convert &quot;localhost:80&quot; to &quot;localhost&quot;</span>
<span class="cp">{{</span> <span class="s1">&#39;localhost:80&#39;</span> <span class="o">|</span> <span class="nf">regex_replace</span><span class="o">(</span><span class="s1">&#39;:80&#39;</span><span class="o">)</span> <span class="cp">}}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you want to match the whole string and you are using <code class="docutils literal notranslate"><span class="pre">*</span></code> make sure to always wraparound your regular expression with the start/end anchors.
For example <code class="docutils literal notranslate"><span class="pre">^(.*)$</span></code> will always match only one result, while <code class="docutils literal notranslate"><span class="pre">(.*)</span></code> on some Python versions will match the whole string and an empty string at the
end, which means it will make two replacements.</p>
<blockquote>
<div><p># add “<a class="reference external" href="https://">https://</a>” prefix to each item in a list
GOOD:
{{ hosts | map(‘regex_replace’, ‘^(.*)$’, ‘<a class="reference external" href="https://">https://</a>\1’) | list }}
{{ hosts | map(‘regex_replace’, ‘(.+)’, ‘<a class="reference external" href="https://">https://</a>\1’) | list }}
{{ hosts | map(‘regex_replace’, ‘^’, ‘<a class="reference external" href="https://">https://</a>’) | list }}</p>
<p>BAD:
{{ hosts | map(‘regex_replace’, ‘(.*)’, ‘<a class="reference external" href="https://">https://</a>\1’) | list }}</p>
<p># append ‘:80’ to each item in a list
GOOD:
{{ hosts | map(‘regex_replace’, ‘^(.*)$’, ‘\1:80’) | list }}
{{ hosts | map(‘regex_replace’, ‘(.+)’, ‘\1:80’) | list }}
{{ hosts | map(‘regex_replace’, ‘$’, ‘:80’) | list }}</p>
<p>BAD:
{{ hosts | map(‘regex_replace’, ‘(.*)’, ‘\1:80’) | list }}</p>
</div></blockquote>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Prior to ansible 2.0, if “regex_replace” filter was used with variables inside YAML arguments (as opposed to simpler ‘key=value’ arguments),
then you needed to escape backreferences (e.g. <code class="docutils literal notranslate"><span class="pre">\\1</span></code>) with 4 backslashes (<code class="docutils literal notranslate"><span class="pre">\\\\</span></code>) instead of 2 (<code class="docutils literal notranslate"><span class="pre">\\</span></code>).</p>
</div>
<div class="versionadded">
<p><span class="versionmodified added">New in version 2.0.</span></p>
</div>
<p>To escape special characters within a standard Python regex, use the “regex_escape” filter (using the default re_type=’python’ option):</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="c1"># convert &#39;^f.*o(.*)$&#39; to &#39;\^f\.\*o\(\.\*\)\$&#39;</span>
<span class="cp">{{</span> <span class="s1">&#39;^f.*o(.*)$&#39;</span> <span class="o">|</span> <span class="nf">regex_escape</span><span class="o">()</span> <span class="cp">}}</span>
</pre></div>
</div>
<div class="versionadded">
<p><span class="versionmodified added">New in version 2.8.</span></p>
</div>
<p>To escape special characters within a POSIX basic regex, use the “regex_escape” filter with the re_type=’posix_basic’ option:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="c1"># convert &#39;^f.*o(.*)$&#39; to &#39;\^f\.\*o(\.\*)\$&#39;</span>
<span class="cp">{{</span> <span class="s1">&#39;^f.*o(.*)$&#39;</span> <span class="o">|</span> <span class="nf">regex_escape</span><span class="o">(</span><span class="s1">&#39;posix_basic&#39;</span><span class="o">)</span> <span class="cp">}}</span>
</pre></div>
</div>
</div>
<div class="section" id="kubernetes-filters">
<h2><a class="toc-backref" href="#id35">Kubernetes Filters</a><a class="headerlink" href="#kubernetes-filters" title="Permalink to this headline">¶</a></h2>
<p>Use the “k8s_config_resource_name” filter to obtain the name of a Kubernetes ConfigMap or Secret,
including its hash:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="cp">{{</span> <span class="nv">configmap_resource_definition</span> <span class="o">|</span> <span class="nf">k8s_config_resource_name</span> <span class="cp">}}</span>
</pre></div>
</div>
<p>This can then be used to reference hashes in Pod specifications:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="nt">my_secret</span><span class="p">:</span>
  <span class="nt">kind</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Secret</span>
  <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">my_secret_name</span>

<span class="nt">deployment_resource</span><span class="p">:</span>
  <span class="nt">kind</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Deployment</span>
  <span class="nt">spec</span><span class="p">:</span>
    <span class="nt">template</span><span class="p">:</span>
      <span class="nt">spec</span><span class="p">:</span>
        <span class="nt">containers</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="nt">envFrom</span><span class="p">:</span>
            <span class="p p-Indicator">-</span> <span class="nt">secretRef</span><span class="p">:</span>
                <span class="nt">name</span><span class="p">:</span> <span class="cp">{{</span> <span class="nv">my_secret</span> <span class="o">|</span> <span class="nf">k8s_config_resource_name</span> <span class="cp">}}</span>
</pre></div>
</div>
<div class="versionadded">
<p><span class="versionmodified added">New in version 2.8.</span></p>
</div>
</div>
<div class="section" id="id8">
<h2><a class="toc-backref" href="#id36">Other Useful Filters</a><a class="headerlink" href="#id8" title="Permalink to this headline">¶</a></h2>
<p>To add quotes for shell usage:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="nt">shell</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">echo</span> <span class="cp">{{</span> <span class="nv">string_value</span> <span class="o">|</span> <span class="nf">quote</span> <span class="cp">}}</span>
</pre></div>
</div>
<p>To use one value on true and another on false (new in version 1.9):</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="cp">{{</span> <span class="o">(</span><span class="nv">name</span> <span class="o">==</span> <span class="s2">&quot;John&quot;</span><span class="o">)</span> <span class="o">|</span> <span class="nf">ternary</span><span class="o">(</span><span class="s1">&#39;Mr&#39;</span><span class="o">,</span><span class="s1">&#39;Ms&#39;</span><span class="o">)</span> <span class="cp">}}</span>
</pre></div>
</div>
<p>To use one value on true, one value on false and a third value on null (new in version 2.8):</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="cp">{{</span> <span class="nv">enabled</span> <span class="o">|</span> <span class="nf">ternary</span><span class="o">(</span><span class="s1">&#39;no shutdown&#39;</span><span class="o">,</span> <span class="s1">&#39;shutdown&#39;</span><span class="o">,</span> <span class="nv">omit</span><span class="o">)</span> <span class="cp">}}</span>
</pre></div>
</div>
<p>To concatenate a list into a string:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="cp">{{</span> <span class="nv">list</span> <span class="o">|</span> <span class="nf">join</span><span class="o">(</span><span class="s2">&quot; &quot;</span><span class="o">)</span> <span class="cp">}}</span>
</pre></div>
</div>
<p>To get the last name of a file path, like ‘foo.txt’ out of ‘/etc/asdf/foo.txt’:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="cp">{{</span> <span class="nv">path</span> <span class="o">|</span> <span class="nf">basename</span> <span class="cp">}}</span>
</pre></div>
</div>
<p>To get the last name of a windows style file path (new in version 2.0):</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="cp">{{</span> <span class="nv">path</span> <span class="o">|</span> <span class="nf">win_basename</span> <span class="cp">}}</span>
</pre></div>
</div>
<p>To separate the windows drive letter from the rest of a file path (new in version 2.0):</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="cp">{{</span> <span class="nv">path</span> <span class="o">|</span> <span class="nf">win_splitdrive</span> <span class="cp">}}</span>
</pre></div>
</div>
<p>To get only the windows drive letter:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="cp">{{</span> <span class="nv">path</span> <span class="o">|</span> <span class="nf">win_splitdrive</span> <span class="o">|</span> <span class="nf">first</span> <span class="cp">}}</span>
</pre></div>
</div>
<p>To get the rest of the path without the drive letter:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="cp">{{</span> <span class="nv">path</span> <span class="o">|</span> <span class="nf">win_splitdrive</span> <span class="o">|</span> <span class="nf">last</span> <span class="cp">}}</span>
</pre></div>
</div>
<p>To get the directory from a path:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="cp">{{</span> <span class="nv">path</span> <span class="o">|</span> <span class="nf">dirname</span> <span class="cp">}}</span>
</pre></div>
</div>
<p>To get the directory from a windows path (new version 2.0):</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="cp">{{</span> <span class="nv">path</span> <span class="o">|</span> <span class="nf">win_dirname</span> <span class="cp">}}</span>
</pre></div>
</div>
<p>To expand a path containing a tilde (<cite>~</cite>) character (new in version 1.5):</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="cp">{{</span> <span class="nv">path</span> <span class="o">|</span> <span class="nf">expanduser</span> <span class="cp">}}</span>
</pre></div>
</div>
<p>To expand a path containing environment variables:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="cp">{{</span> <span class="nv">path</span> <span class="o">|</span> <span class="nf">expandvars</span> <span class="cp">}}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><cite>expandvars</cite> expands local variables; using it on remote paths can lead to errors.</p>
</div>
<div class="versionadded">
<p><span class="versionmodified added">New in version 2.6.</span></p>
</div>
<p>To get the real path of a link (new in version 1.8):</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="cp">{{</span> <span class="nv">path</span> <span class="o">|</span> <span class="nf">realpath</span> <span class="cp">}}</span>
</pre></div>
</div>
<p>To get the relative path of a link, from a start point (new in version 1.7):</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="cp">{{</span> <span class="nv">path</span> <span class="o">|</span> <span class="nf">relpath</span><span class="o">(</span><span class="s1">&#39;/etc&#39;</span><span class="o">)</span> <span class="cp">}}</span>
</pre></div>
</div>
<p>To get the root and extension of a path or filename (new in version 2.0):</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="c1"># with path == &#39;nginx.conf&#39; the return would be (&#39;nginx&#39;, &#39;.conf&#39;)</span>
<span class="cp">{{</span> <span class="nv">path</span> <span class="o">|</span> <span class="nf">splitext</span> <span class="cp">}}</span>
</pre></div>
</div>
<p>To work with Base64 encoded strings:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="cp">{{</span> <span class="nv">encoded</span> <span class="o">|</span> <span class="nf">b64decode</span> <span class="cp">}}</span>
<span class="cp">{{</span> <span class="nv">decoded</span> <span class="o">|</span> <span class="nf">string</span> <span class="o">|</span> <span class="nf">b64encode</span> <span class="cp">}}</span>
</pre></div>
</div>
<p>As of version 2.6, you can define the type of encoding to use, the default is <code class="docutils literal notranslate"><span class="pre">utf-8</span></code>:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="cp">{{</span> <span class="nv">encoded</span> <span class="o">|</span> <span class="nf">b64decode</span><span class="o">(</span><span class="nv">encoding</span><span class="o">=</span><span class="s1">&#39;utf-16-le&#39;</span><span class="o">)</span> <span class="cp">}}</span>
<span class="cp">{{</span> <span class="nv">decoded</span> <span class="o">|</span> <span class="nf">string</span> <span class="o">|</span> <span class="nf">b64encode</span><span class="o">(</span><span class="nv">encoding</span><span class="o">=</span><span class="s1">&#39;utf-16-le&#39;</span><span class="o">)</span> <span class="cp">}}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code class="docutils literal notranslate"><span class="pre">string</span></code> filter is only required for Python 2 and ensures that text to encode is a unicode string.
Without that filter before b64encode the wrong value will be encoded.</p>
</div>
<div class="versionadded">
<p><span class="versionmodified added">New in version 2.6.</span></p>
</div>
<p>To create a UUID from a string (new in version 1.9):</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="cp">{{</span> <span class="nv">hostname</span> <span class="o">|</span> <span class="nf">to_uuid</span> <span class="cp">}}</span>
</pre></div>
</div>
<p>To cast values as certain types, such as when you input a string as “True” from a vars_prompt and the system
doesn’t know it is a boolean value:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="nt">debug</span><span class="p">:</span>
    <span class="nt">msg</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">test</span>
  <span class="nt">when</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">some_string_value | bool</span>
</pre></div>
</div>
<div class="versionadded">
<p><span class="versionmodified added">New in version 1.6.</span></p>
</div>
<p>To make use of one attribute from each item in a list of complex variables, use the “map” filter (see the <a class="reference external" href="http://jinja.pocoo.org/docs/dev/templates/#map">Jinja2 map() docs</a> for more):</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="c1"># get a comma-separated list of the mount points (e.g. &quot;/,/mnt/stuff&quot;) on a host</span>
<span class="cp">{{</span> <span class="nv">ansible_mounts</span> <span class="o">|</span> <span class="nf">map</span><span class="o">(</span><span class="nv">attribute</span><span class="o">=</span><span class="s1">&#39;mount&#39;</span><span class="o">)</span> <span class="o">|</span> <span class="nf">join</span><span class="o">(</span><span class="s1">&#39;,&#39;</span><span class="o">)</span> <span class="cp">}}</span>
</pre></div>
</div>
<p>To get date object from string use the <cite>to_datetime</cite> filter, (new in version in 2.2):</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get total amount of seconds between two dates. Default date format is %Y-%m-%d %H:%M:%S but you can pass your own format</span>
<span class="cp">{{</span> <span class="o">((</span><span class="s2">&quot;2016-08-14 20:00:12&quot;</span> <span class="o">|</span> <span class="nf">to_datetime</span><span class="o">)</span> <span class="o">-</span> <span class="o">(</span><span class="s2">&quot;2015-12-25&quot;</span> <span class="o">|</span> <span class="nf">to_datetime</span><span class="o">(</span><span class="s1">&#39;%Y-%m-%d&#39;</span><span class="o">)))</span><span class="nv">.total_seconds</span><span class="o">()</span>  <span class="cp">}}</span>

<span class="c1"># Get remaining seconds after delta has been calculated. NOTE: This does NOT convert years, days, hours, etc to seconds. For that, use total_seconds()</span>
<span class="cp">{{</span> <span class="o">((</span><span class="s2">&quot;2016-08-14 20:00:12&quot;</span> <span class="o">|</span> <span class="nf">to_datetime</span><span class="o">)</span> <span class="o">-</span> <span class="o">(</span><span class="s2">&quot;2016-08-14 18:00:00&quot;</span> <span class="o">|</span> <span class="nf">to_datetime</span><span class="o">))</span><span class="nv">.seconds</span>  <span class="cp">}}</span>
<span class="c1"># This expression evaluates to &quot;12&quot; and not &quot;132&quot;. Delta is 2 hours, 12 seconds</span>

<span class="c1"># get amount of days between two dates. This returns only number of days and discards remaining hours, minutes, and seconds</span>
<span class="cp">{{</span> <span class="o">((</span><span class="s2">&quot;2016-08-14 20:00:12&quot;</span> <span class="o">|</span> <span class="nf">to_datetime</span><span class="o">)</span> <span class="o">-</span> <span class="o">(</span><span class="s2">&quot;2015-12-25&quot;</span> <span class="o">|</span> <span class="nf">to_datetime</span><span class="o">(</span><span class="s1">&#39;%Y-%m-%d&#39;</span><span class="o">)))</span><span class="nv">.days</span>  <span class="cp">}}</span>
</pre></div>
</div>
<div class="versionadded">
<p><span class="versionmodified added">New in version 2.4.</span></p>
</div>
<p>To format a date using a string (like with the shell date command), use the “strftime” filter:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="c1"># Display year-month-day</span>
<span class="cp">{{</span> <span class="s1">&#39;%Y-%m-%d&#39;</span> <span class="o">|</span> <span class="nf">strftime</span> <span class="cp">}}</span>

<span class="c1"># Display hour:min:sec</span>
<span class="cp">{{</span> <span class="s1">&#39;%H:%M:%S&#39;</span> <span class="o">|</span> <span class="nf">strftime</span> <span class="cp">}}</span>

<span class="c1"># Use ansible_date_time.epoch fact</span>
<span class="cp">{{</span> <span class="s1">&#39;%Y-%m-%d %H:%M:%S&#39;</span> <span class="o">|</span> <span class="nf">strftime</span><span class="o">(</span><span class="nv">ansible_date_time.epoch</span><span class="o">)</span> <span class="cp">}}</span>

<span class="c1"># Use arbitrary epoch value</span>
<span class="cp">{{</span> <span class="s1">&#39;%Y-%m-%d&#39;</span> <span class="o">|</span> <span class="nf">strftime</span><span class="o">(</span><span class="m">0</span><span class="o">)</span> <span class="cp">}}</span>          <span class="c1"># =&gt; 1970-01-01</span>
<span class="cp">{{</span> <span class="s1">&#39;%Y-%m-%d&#39;</span> <span class="o">|</span> <span class="nf">strftime</span><span class="o">(</span><span class="m">1441357287</span><span class="o">)</span> <span class="cp">}}</span> <span class="c1"># =&gt; 2015-09-04</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To get all string possibilities, check <a class="reference external" href="https://docs.python.org/2/library/time.html#time.strftime">https://docs.python.org/2/library/time.html#time.strftime</a></p>
</div>
</div>
<div class="section" id="combination-filters">
<h2><a class="toc-backref" href="#id37">Combination Filters</a><a class="headerlink" href="#combination-filters" title="Permalink to this headline">¶</a></h2>
<div class="versionadded">
<p><span class="versionmodified added">New in version 2.3.</span></p>
</div>
<p>This set of filters returns a list of combined lists.
To get permutations of a list:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">give me largest permutations (order matters)</span>
  <span class="nt">debug</span><span class="p">:</span>
    <span class="nt">msg</span><span class="p">:</span> <span class="s">&quot;</span><span class="cp">{{</span> <span class="o">[</span><span class="m">1</span><span class="o">,</span><span class="m">2</span><span class="o">,</span><span class="m">3</span><span class="o">,</span><span class="m">4</span><span class="o">,</span><span class="m">5</span><span class="o">]</span> <span class="o">|</span> <span class="nf">permutations</span> <span class="o">|</span> <span class="nf">list</span> <span class="cp">}}</span><span class="s">&quot;</span>

<span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">give me permutations of sets of three</span>
  <span class="nt">debug</span><span class="p">:</span>
    <span class="nt">msg</span><span class="p">:</span> <span class="s">&quot;</span><span class="cp">{{</span> <span class="o">[</span><span class="m">1</span><span class="o">,</span><span class="m">2</span><span class="o">,</span><span class="m">3</span><span class="o">,</span><span class="m">4</span><span class="o">,</span><span class="m">5</span><span class="o">]</span> <span class="o">|</span> <span class="nf">permutations</span><span class="o">(</span><span class="m">3</span><span class="o">)</span> <span class="o">|</span> <span class="nf">list</span> <span class="cp">}}</span><span class="s">&quot;</span>
</pre></div>
</div>
<p>Combinations always require a set size:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">give me combinations for sets of two</span>
  <span class="nt">debug</span><span class="p">:</span>
    <span class="nt">msg</span><span class="p">:</span> <span class="s">&quot;</span><span class="cp">{{</span> <span class="o">[</span><span class="m">1</span><span class="o">,</span><span class="m">2</span><span class="o">,</span><span class="m">3</span><span class="o">,</span><span class="m">4</span><span class="o">,</span><span class="m">5</span><span class="o">]</span> <span class="o">|</span> <span class="nf">combinations</span><span class="o">(</span><span class="m">2</span><span class="o">)</span> <span class="o">|</span> <span class="nf">list</span> <span class="cp">}}</span><span class="s">&quot;</span>
</pre></div>
</div>
<p>Also see the <a class="reference internal" href="#zip-filter"><span class="std std-ref">zip and zip_longest filters</span></a></p>
</div>
<div class="section" id="product-filters">
<h2><a class="toc-backref" href="#id38">Product Filters</a><a class="headerlink" href="#product-filters" title="Permalink to this headline">¶</a></h2>
<p>The product filter returns the <a class="reference external" href="https://docs.python.org/3/library/itertools.html#itertools.product">cartesian product</a> of the input iterables.</p>
<p>This is roughly equivalent to nested for-loops in a generator expression.</p>
<p>For example:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">generate multiple hostnames</span>
  <span class="nt">debug</span><span class="p">:</span>
    <span class="nt">msg</span><span class="p">:</span> <span class="s">&quot;</span><span class="cp">{{</span> <span class="o">[</span><span class="s1">&#39;foo&#39;</span><span class="o">,</span> <span class="s1">&#39;bar&#39;</span><span class="o">]</span> <span class="o">|</span> <span class="nf">product</span><span class="o">([</span><span class="s1">&#39;com&#39;</span><span class="o">])</span> <span class="o">|</span> <span class="nf">map</span><span class="o">(</span><span class="s1">&#39;join&#39;</span><span class="o">,</span> <span class="s1">&#39;.&#39;</span><span class="o">)</span> <span class="o">|</span> <span class="nf">join</span><span class="o">(</span><span class="s1">&#39;,&#39;</span><span class="o">)</span> <span class="cp">}}</span><span class="s">&quot;</span>
</pre></div>
</div>
<p>This would result in:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">{</span> <span class="s">&quot;msg&quot;</span><span class="p p-Indicator">:</span> <span class="s">&quot;foo.com,bar.com&quot;</span> <span class="p p-Indicator">}</span>
</pre></div>
</div>
</div>
<div class="section" id="debugging-filters">
<h2><a class="toc-backref" href="#id39">Debugging Filters</a><a class="headerlink" href="#debugging-filters" title="Permalink to this headline">¶</a></h2>
<div class="versionadded">
<p><span class="versionmodified added">New in version 2.3.</span></p>
</div>
<p>Use the <code class="docutils literal notranslate"><span class="pre">type_debug</span></code> filter to display the underlying Python type of a variable.
This can be useful in debugging in situations where you may need to know the exact
type of a variable:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="cp">{{</span> <span class="nv">myvar</span> <span class="o">|</span> <span class="nf">type_debug</span> <span class="cp">}}</span>
</pre></div>
</div>
</div>
<div class="section" id="computer-theory-assertions">
<h2><a class="toc-backref" href="#id40">Computer Theory Assertions</a><a class="headerlink" href="#computer-theory-assertions" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">human_readable</span></code> and <code class="docutils literal notranslate"><span class="pre">human_to_bytes</span></code> functions let you test your
playbooks to make sure you are using the right size format in your tasks - that
you’re providing Byte format to computers and human-readable format to people.</p>
</div>
<div class="section" id="human-readable">
<h2><a class="toc-backref" href="#id41">Human Readable</a><a class="headerlink" href="#human-readable" title="Permalink to this headline">¶</a></h2>
<p>Asserts whether the given string is human readable or not.</p>
<p>For example:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="s">&quot;Human</span><span class="nv"> </span><span class="s">Readable&quot;</span>
  <span class="nt">assert</span><span class="p">:</span>
    <span class="nt">that</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="s">&#39;&quot;1.00</span><span class="nv"> </span><span class="s">Bytes&quot;</span><span class="nv"> </span><span class="s">==</span><span class="nv"> </span><span class="s">1|human_readable&#39;</span>
      <span class="p p-Indicator">-</span> <span class="s">&#39;&quot;1.00</span><span class="nv"> </span><span class="s">bits&quot;</span><span class="nv"> </span><span class="s">==</span><span class="nv"> </span><span class="s">1|human_readable(isbits=True)&#39;</span>
      <span class="p p-Indicator">-</span> <span class="s">&#39;&quot;10.00</span><span class="nv"> </span><span class="s">KB&quot;</span><span class="nv"> </span><span class="s">==</span><span class="nv"> </span><span class="s">10240|human_readable&#39;</span>
      <span class="p p-Indicator">-</span> <span class="s">&#39;&quot;97.66</span><span class="nv"> </span><span class="s">MB&quot;</span><span class="nv"> </span><span class="s">==</span><span class="nv"> </span><span class="s">102400000|human_readable&#39;</span>
      <span class="p p-Indicator">-</span> <span class="s">&#39;&quot;0.10</span><span class="nv"> </span><span class="s">GB&quot;</span><span class="nv"> </span><span class="s">==</span><span class="nv"> </span><span class="s">102400000|human_readable(unit=&quot;G&quot;)&#39;</span>
      <span class="p p-Indicator">-</span> <span class="s">&#39;&quot;0.10</span><span class="nv"> </span><span class="s">Gb&quot;</span><span class="nv"> </span><span class="s">==</span><span class="nv"> </span><span class="s">102400000|human_readable(isbits=True,</span><span class="nv"> </span><span class="s">unit=&quot;G&quot;)&#39;</span>
</pre></div>
</div>
<p>This would result in:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">{</span> <span class="s">&quot;changed&quot;</span><span class="p p-Indicator">:</span> <span class="nv">false</span><span class="p p-Indicator">,</span> <span class="s">&quot;msg&quot;</span><span class="p p-Indicator">:</span> <span class="s">&quot;All</span><span class="nv"> </span><span class="s">assertions</span><span class="nv"> </span><span class="s">passed&quot;</span> <span class="p p-Indicator">}</span>
</pre></div>
</div>
</div>
<div class="section" id="human-to-bytes">
<h2><a class="toc-backref" href="#id42">Human to Bytes</a><a class="headerlink" href="#human-to-bytes" title="Permalink to this headline">¶</a></h2>
<p>Returns the given string in the Bytes format.</p>
<p>For example:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="s">&quot;Human</span><span class="nv"> </span><span class="s">to</span><span class="nv"> </span><span class="s">Bytes&quot;</span>
  <span class="nt">assert</span><span class="p">:</span>
    <span class="nt">that</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="s">&quot;</span><span class="cp">{{</span><span class="s1">&#39;0&#39;</span><span class="o">|</span><span class="nf">human_to_bytes</span><span class="cp">}}</span><span class="nv">        </span><span class="s">==</span><span class="nv"> </span><span class="s">0&quot;</span>
      <span class="p p-Indicator">-</span> <span class="s">&quot;</span><span class="cp">{{</span><span class="s1">&#39;0.1&#39;</span><span class="o">|</span><span class="nf">human_to_bytes</span><span class="cp">}}</span><span class="nv">      </span><span class="s">==</span><span class="nv"> </span><span class="s">0&quot;</span>
      <span class="p p-Indicator">-</span> <span class="s">&quot;</span><span class="cp">{{</span><span class="s1">&#39;0.9&#39;</span><span class="o">|</span><span class="nf">human_to_bytes</span><span class="cp">}}</span><span class="nv">      </span><span class="s">==</span><span class="nv"> </span><span class="s">1&quot;</span>
      <span class="p p-Indicator">-</span> <span class="s">&quot;</span><span class="cp">{{</span><span class="s1">&#39;1&#39;</span><span class="o">|</span><span class="nf">human_to_bytes</span><span class="cp">}}</span><span class="nv">        </span><span class="s">==</span><span class="nv"> </span><span class="s">1&quot;</span>
      <span class="p p-Indicator">-</span> <span class="s">&quot;</span><span class="cp">{{</span><span class="s1">&#39;10.00 KB&#39;</span><span class="o">|</span><span class="nf">human_to_bytes</span><span class="cp">}}</span><span class="nv"> </span><span class="s">==</span><span class="nv"> </span><span class="s">10240&quot;</span>
      <span class="p p-Indicator">-</span> <span class="s">&quot;</span><span class="cp">{{</span>   <span class="s1">&#39;11 MB&#39;</span><span class="o">|</span><span class="nf">human_to_bytes</span><span class="cp">}}</span><span class="nv"> </span><span class="s">==</span><span class="nv"> </span><span class="s">11534336&quot;</span>
      <span class="p p-Indicator">-</span> <span class="s">&quot;</span><span class="cp">{{</span>  <span class="s1">&#39;1.1 GB&#39;</span><span class="o">|</span><span class="nf">human_to_bytes</span><span class="cp">}}</span><span class="nv"> </span><span class="s">==</span><span class="nv"> </span><span class="s">1181116006&quot;</span>
      <span class="p p-Indicator">-</span> <span class="s">&quot;</span><span class="cp">{{</span><span class="s1">&#39;10.00 Kb&#39;</span><span class="o">|</span><span class="nf">human_to_bytes</span><span class="o">(</span><span class="nv">isbits</span><span class="o">=</span><span class="kp">True</span><span class="o">)</span><span class="cp">}}</span><span class="nv"> </span><span class="s">==</span><span class="nv"> </span><span class="s">10240&quot;</span>
</pre></div>
</div>
<p>This would result in:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">{</span> <span class="s">&quot;changed&quot;</span><span class="p p-Indicator">:</span> <span class="nv">false</span><span class="p p-Indicator">,</span> <span class="s">&quot;msg&quot;</span><span class="p p-Indicator">:</span> <span class="s">&quot;All</span><span class="nv"> </span><span class="s">assertions</span><span class="nv"> </span><span class="s">passed&quot;</span> <span class="p p-Indicator">}</span>
</pre></div>
</div>
<p>A few useful filters are typically added with each new Ansible release.  The development documentation shows
how to extend Ansible filters by writing your own as plugins, though in general, we encourage new ones
to be added to core so everyone can make use of them.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="playbooks_intro.html#about-playbooks"><span class="std std-ref">About Playbooks</span></a></dt><dd><p>An introduction to playbooks</p>
</dd>
<dt><a class="reference internal" href="playbooks_conditionals.html#playbooks-conditionals"><span class="std std-ref">Conditionals</span></a></dt><dd><p>Conditional statements in playbooks</p>
</dd>
<dt><a class="reference internal" href="playbooks_variables.html#playbooks-variables"><span class="std std-ref">Using Variables</span></a></dt><dd><p>All about variables</p>
</dd>
<dt><a class="reference internal" href="playbooks_loops.html#playbooks-loops"><span class="std std-ref">Loops</span></a></dt><dd><p>Looping in playbooks</p>
</dd>
<dt><a class="reference internal" href="playbooks_reuse_roles.html#playbooks-reuse-roles"><span class="std std-ref">Roles</span></a></dt><dd><p>Playbook organization by roles</p>
</dd>
<dt><a class="reference internal" href="playbooks_best_practices.html#playbooks-best-practices"><span class="std std-ref">Best Practices</span></a></dt><dd><p>Best practices in playbooks</p>
</dd>
<dt><a class="reference external" href="https://groups.google.com/group/ansible-devel">User Mailing List</a></dt><dd><p>Have a question?  Stop by the google group!</p>
</dd>
<dt><a class="reference external" href="http://irc.freenode.net">irc.freenode.net</a></dt><dd><p>#ansible IRC chat channel</p>
</dd>
</dl>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons">
      
        <a href="playbooks_tests.html" class="btn btn-neutral float-right" title="Tests"/>Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="playbooks_templating.html" class="btn btn-neutral" title="Templating (Jinja2)"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>


<script type="text/javascript">
  (function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
  (w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
  e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
  })(window,document,'script','//s.swiftypecdn.com/install/v2/st.js','_st');

  _st('install','yABGvz2N8PwcwBxyfzUc','2.0.0');
</script>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019 Red Hat, Inc.
      <span class="lastupdated">
        Last updated on Apr 28, 2020.
      </span>

    </p>
  </div> 
</footer>
        </div>
      </div>

    </section>

  </div>

  <script type="text/javascript">
      jQuery(function () {
          
          SphinxRtdTheme.Navigation.enableSticky();
          
      });
  </script>

  
  
    
   <!-- extra footer elements for Ansible beyond RTD Sphinx Theme --->
<!-- begin analytics -->
<script type="text/javascript">
var _hsq = _hsq || [];
_hsq.push(["setContentType", "standard-page"]);
      (function(d,s,i,r) {
      if (d.getElementById(i)){return;}
      var n = d.createElement(s),e = document.getElementsByTagName(s)[0];
      n.id=i;n.src = '//js.hs-analytics.net/analytics/'+(Math.ceil(new Date()/r)*r)+'/330046.js';
      e.parentNode.insertBefore(n, e);
      })(document, "script", "hs-analytics",300000);
</script>
<!-- end analytics -->
<script type="text/javascript">
if (("undefined" !== typeof _satellite) && ("function" === typeof _satellite.pageBottom)) {
  _satellite.pageBottom();
}
</script> 

</body>
</html>